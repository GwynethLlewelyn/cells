!function r(o,a,i){function l(t,e){if(!a[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,r,o,a,i)}return a[t].exports}for(var s="function"==typeof require&&require,e=0;e<i.length;e++)l(i[e]);return l}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;i(e("pydio"));var u=i(e("react")),r=i(e("create-react-class")),o=e("material-ui/styles"),c=i(e("./JobBoard")),d=i(e("./JobsList")),a=i(e("./Loader"));function i(e){return e&&e.__esModule?e:{default:e}}r=(0,r.default)({displayName:"Dashboard",mixins:[AdminComponents.MessagesConsumerMixin],getInitialState:function(){return{jobs:[],Owner:null,Filter:null}},reload:function(){this.loader.load()},componentDidMount:function(){var t=this;this.loader=new a.default,this.loader.observe("loading",function(){t.setState({loading:!0})}),this.loader.observe("loaded",function(e){t.setState({loading:!1}),e.jobs?t.setState({jobs:e.jobs}):e.error&&t.setState({error:e.error})}),this.loader.start()},componentWillUnmount:function(){this.loader.stop()},selectRows:function(e){e.length&&(e=e[0].ID,this.loader.stop(),this.setState({selectJob:e}))},render:function(){var e,t=this,n=this.props,r=n.pydio,o=n.jobsEditable,a=n.muiTheme,i=AdminComponents.AdminStyles(a.palette),l=this.state,n=l.jobs,a=l.loading,s=l.selectJob;if(s&&n){l=n.filter(function(e){return e.ID===s});if(l.length)return u.default.createElement(c.default,{pydio:r,job:l[0],jobsEditable:o,onSave:function(){t.reload()},adminStyles:i,onRequestClose:function(){t.loader.start(),t.setState({selectJob:null})}})}return u.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"}},u.default.createElement(AdminComponents.Header,{title:(e="title",r.MessageHash["ajxp_admin.scheduler."+e]||e),icon:"mdi mdi-timetable",reloadAction:this.reload.bind(this),loading:a}),u.default.createElement(d.default,{pydio:r,selectRows:function(e){t.selectRows(e)},jobs:n,loading:a,jobsEditable:o}))}});n.default=r,n.default=r=(0,o.muiThemeable)()(r),t.exports=n.default},{"./JobBoard":3,"./JobsList":6,"./Loader":7,"create-react-class":"create-react-class","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],2:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("react")),l=r(e("pydio")),s=e("material-ui");e("cells-sdk");function r(e){return e&&e.__esModule?e:{default:e}}function a(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function u(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function c(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=l.default.requireLib("components").Stepper,h=e.Dialog,b=e.PanelBigButtons,g={NODE_CHANGE:{title:"Files and folders (nodes) events : detect files modifications to move them or update their metadata automatically.",0:{title:"trigger.create.node",icon:"file-plus",description:"A new file was uploaded or a new folder was created"},1:{title:"trigger.read.node",icon:"eye",description:"A file was downloaded or a folder content was listed"},2:{title:"trigger.update.path",icon:"folder-move",description:"A file or folder was moved or renamed"},3:{title:"trigger.update.content",icon:"content-save",description:"A file content was updated by edition or upload overwriting"},5:{title:"trigger.delete.node",icon:"delete",description:"A file or a folder was definitively deleted"},4:{title:"trigger.update.metadata",icon:"tag",description:"Internal metadata were modified on file or folder"},6:{title:"trigger.update.user-metadata",icon:"tag-multiple",description:"User-defined metadata were modified (event contains updated metadata)"}},IDM_CHANGE:{USER:{title:"User events : triggered when adding/removing user and when users log in and log out. Can be used for triggering validation flows or assigning accesses.",0:{title:"trigger.create.user",icon:"account-plus",tint:"#009688",description:"A user or a group was created"},1:{title:"trigger.read.user",icon:"account",tint:"#009688",description:"A user or a group was accessed"},2:{title:"trigger.update.user",icon:"account-box",tint:"#009688",description:"A user or a group data was updated"},3:{title:"trigger.delete.user",icon:"account-minus",tint:"#009688",description:"A user or a group was deleted"},4:{title:"trigger.bind.user",icon:"login",tint:"#009688",description:"A user has logged in"},5:{title:"trigger.logout.user",icon:"logout",tint:"#009688",description:"A user has logged out"}},ROLE:{title:"Role events : can be used to automate accesses based on role names. Use IsTeam, IsGroup, IsUser flags to filter roles.",0:{title:"Create Role",icon:"account-card-details",tint:"#607d8b",description:"New role created."},2:{title:"Update Role",icon:"pencil",tint:"#607d8b",description:"A role has been updated"},3:{title:"Delete Role",icon:"delete-forever",tint:"#607d8b",description:"A role has been deleted"}},WORKSPACE:{title:"Workspace events : triggered on workspace creation / deletion. Use the Scope flag to filter Workspaces from Cells",0:{title:"Create Workspace",icon:"folder-plus",tint:"#ff9800",description:"A workspace has been created"},2:{title:"Update Workspace",icon:"pencil",tint:"#ff9800",description:"A workspace has been updated"},3:{title:"Delete Workspace",icon:"delete-forever",tint:"#ff9800",description:"New file uploaded or folder created"}},ACL:{title:"ACL events : access control lists link workspaces, nodes and roles together to provide accesses to data.",0:{title:"Create Acl",icon:"view-list",tint:"#795548",description:"An access control has been opened"},3:{title:"Delete Acl",icon:"delete-forever",tint:"#795548",description:"An access control has been closed"}}}},e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(a,i["default"].Component);var e,t,n,r=m(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).state={objEvents:t.toObject(e.events||[])},t}return e=a,n=[{key:"eventData",value:function(e){var t=e.split(":"),e=2===t.length&&g[t[0]]?g[t[0]][t[1]]:3===t.length&&g[t[0]]&&g[t[0]][t[1]]&&g[t[0]][t[1]][t[2]]?g[t[0]][t[1]][t[2]]:{title:e,icon:"pulse",description:""};return{title:a.T(e.title),description:a.T(e.description),icon:"mdi mdi-"+e.icon,tint:e.tint}}},{key:"T",value:function(e){return l.default.getMessages()["ajxp_admin.scheduler."+e]||e}},{key:"flatStruct",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],o=[];return Object.keys(n).forEach(function(e){var t;"title"!==e&&(isNaN(e)&&"IDM_CHANGE"!==e&&o.push({header:n[e].title}),t=n[e],isNaN(e)?o.push.apply(o,c(a.flatStruct(t,[].concat(c(r),[e])))):o.push([].concat(c(r),[e]).join(":")))}),o}},{key:"eventsAsBBModel",value:function(n){var r,e=a.flatStruct(g),o={Sections:[]};return e.forEach(function(e){var t;e.header?(r&&r.Actions.length&&o.Sections.push(r),r={title:e.header,Actions:[]}):(t=a.eventData(e),n&&-1===t.title.toLowerCase().indexOf(n)&&-1===t.description.toLowerCase().indexOf(n)||r.Actions.push(u(u({},t),{},{value:e})))}),r&&o.Sections.push(r),o}}],(t=[{key:"onChange",value:function(){this.props.onChange(Object.keys(this.state.objEvents))}},{key:"toObject",value:function(){var t={};return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){t[e]=e}),t}},{key:"remove",value:function(e){var t=this.state.objEvents;delete t[e],this.setState({objEvents:t},this.onChange.bind(this))}},{key:"add",value:function(e){var t=this.state.objEvents;t[e]=e,this.setState({objEvents:t},this.onChange.bind(this))}},{key:"dismiss",value:function(){this.setState({open:!1,filter:""})}},{key:"render",value:function(){var t=this,e=this.state,n=e.objEvents,r=e.open,e=e.filter,o=[];Object.keys(n).forEach(function(e){o.push(i.default.createElement(s.ListItem,{key:e,disabled:!0,primaryText:a.eventData(e).title,rightIconButton:i.default.createElement(s.IconButton,{iconClassName:"mdi mdi-delete",iconStyle:{color:"#e0e0e0"},onClick:function(){t.remove(e)}})})),o.push(i.default.createElement(s.Divider,null))}),o.pop();e=a.eventsAsBBModel(e);return i.default.createElement("div",null,i.default.createElement(h,{title:"Trigger job on...",open:r,dialogProps:{},onDismiss:function(){t.dismiss()},onFilter:function(e){t.setState({filter:e.toLowerCase()})}},i.default.createElement(b,{model:e,onPick:function(e){t.add(e),t.dismiss()}})),i.default.createElement(s.FlatButton,{style:{width:"100%"},label:"Trigger job on...",primary:!0,onClick:function(){return t.setState({open:!0})},icon:i.default.createElement(s.FontIcon,{className:"mdi mdi-pulse"})}),i.default.createElement(s.List,null,o))}}])&&f(e.prototype,t),n&&f(e,n),a}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio",react:"react"}],3:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var p=l(e("react")),r=l(e("pydio")),a=l(e("pydio/http/api")),i=e("cells-sdk"),m=e("material-ui"),y=l(e("./TasksList")),h=l(e("./JobSchedule")),b=l(e("./Loader")),g=l(e("./JobParameters"));function l(e){return e&&e.__esModule?e:{default:e}}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function S(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?s(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(n);return e=r?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=r.default.requireLib("boot").JobsStore,r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,p["default"].Component);var e,t,n,r=d(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).state={mode:"log",selectedRows:[],loading:!1,taskLogs:null,job:e.job,create:e.create,descriptions:{}},t.loader=new b.default(e.job.ID),t.loader.observe("loaded",function(e){e.job?t.setState({job:e.job,error:null}):e.error&&t.setState({error:e.error})}),t}return e=o,(t=[{key:"componentDidMount",value:function(){var t=this;this.loader.start(),new i.ConfigServiceApi(a.default.getRestClient()).schedulerActionsDiscovery().then(function(e){t.setState({descriptions:e.Actions})})}},{key:"componentWillUnmount",value:function(){this.loader.stop()}},{key:"canManualRun",value:function(e){if(e.Schedule||!e.EventNames)return!0;var t=!1;try{e.Actions.forEach(function(e){e.TriggerFilter&&e.TriggerFilter.Query.SubQueries.forEach(function(e){e.value.IsManual&&(t=!0)})})}catch(e){}return t}},{key:"render",value:function(){var t=this,e=this.props,n=e.pydio,r=e.jobsEditable,o=e.onRequestClose,a=e.adminStyles,i=this.state,l=i.loading,s=i.create,u=i.job,c=i.descriptions;if(!u)return null;function d(e){return n.MessageHash["ajxp_admin.scheduler."+e]||e}var f=[],e=S({},a.props.header.flatButton),i=a.props.header.flatButton.labelStyle.color;return s||(r&&u.Parameters&&u.Parameters.length&&f.push(p.default.createElement(g.default,{job:u})),b.default.canManualRun(u)&&(r&&f.push(p.default.createElement(h.default,{job:u,edit:!0,onUpdate:function(){}})),r=S({},e),u.Inactive&&(r.backgroundColor="#e0e0e0"),f.push(p.default.createElement(m.FlatButton,v({icon:p.default.createElement(m.FontIcon,{className:"mdi mdi-play",color:i}),label:d("task.action.run"),disabled:u.Inactive,primary:!0,onClick:function(){w.getInstance().controlJob(u,"RunOnce")}},r)))),u.Inactive?f.push(p.default.createElement(m.FlatButton,v({icon:p.default.createElement(m.FontIcon,{className:"mdi mdi-checkbox-marked-circle-outline",color:i}),label:d("task.action.enable"),primary:!0,onClick:function(){w.getInstance().controlJob(u,"Active")}},e))):f.push(p.default.createElement(m.FlatButton,v({icon:p.default.createElement(m.FontIcon,{className:"mdi mdi-checkbox-blank-circle-outline",color:i}),label:d("task.action.disable"),primary:!0,onClick:function(){w.getInstance().controlJob(u,"Inactive")}},e)))),p.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"}},p.default.createElement(AdminComponents.Header,{title:p.default.createElement("span",null,p.default.createElement("a",{style:{cursor:"pointer",borderBottom:"1px solid rgba(0,0,0,.87)"},onClick:function(){return o(!0)}},n.MessageHash["ajxp_admin.scheduler.title"])," / ",u.Label," ",u.Inactive?" [disabled]":""),backButtonAction:function(){return o(!0)},actions:f,loading:l}),p.default.createElement("div",{style:{flex:1,overflowY:"auto"}},p.default.createElement(y.default,{pydio:n,job:u,onLoading:function(e){t.setState({loading:e})},descriptions:c,adminStyles:a})))}}])&&u(e.prototype,t),n&&u(e,n),o}();n.default=r,t.exports=n.default},{"./JobParameters":4,"./JobSchedule":5,"./Loader":7,"./TasksList":10,"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],4:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("react")),i=r(e("pydio")),l=e("material-ui"),s=e("cells-sdk");function r(e){return e&&e.__esModule?e:{default:e}}function u(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function c(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(n);return e=r?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=i.default.requireLib("hoc"),g=e.ModernTextField,v=e.ModernSelectField,S=function(){m(n,a["default"].Component);var t=h(n);function n(e){return d(this,n),t.call(this,e)}return p(n,[{key:"render",value:function(){var e=this.props,r=e.parameter,o=e.onChange,e=(e.m,{margin:"0 5px"}),t={};try{t=JSON.parse(r.JsonChoices)}catch(e){}return a.default.createElement("div",{style:{display:"flex",alignItems:"center"}},a.default.createElement("div",{style:c(c({},e),{},{fontSize:15,width:120,minWidth:120})},r.Name),a.default.createElement("div",{style:c(c({},e),{},{width:200,minWidth:200})},"select"===r.Type&&a.default.createElement(v,{fullWidth:!0,value:r.Value,onChange:function(e,t,n){o(c(c({},r),{},{Value:n}))}},Object.keys(t).map(function(e){return a.default.createElement(l.MenuItem,{value:e,primaryText:t[e]})})),"text"===r.Type&&a.default.createElement(g,{fullWidth:!0,value:r.Value,onChange:function(e,t){o(c(c({},r),{},{Value:t}))}}),"integer"===r.Type&&a.default.createElement(g,{fullWidth:!0,value:parseInt(r.Value),type:"number",onChange:function(e,t){o(c(c({},r),{},{Value:parseInt(t)}))}}),"boolean"===r.Type&&a.default.createElement(v,{fullWidth:!0,value:r.Value,onChange:function(e,t,n){o(c(c({},r),{},{Value:n}))}},a.default.createElement(l.MenuItem,{value:"true",primaryText:i.default.getMessages()[440]}),a.default.createElement(l.MenuItem,{value:"false",primaryText:i.default.getMessages()[441]}))),a.default.createElement("div",{style:c(c({},e),{},{color:"#bdbdbd",fontWeight:500,fontSize:13,fontStyle:"italic",userSelect:"text",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})},r.Description,r.Description&&" "))}}]),n}(),e=function(){m(n,a["default"].Component);var t=h(n);function n(e){return d(this,n),(e=t.call(this,e)).state={open:!1},e}return p(n,[{key:"m",value:function(e){return i.default.getInstance().MessageHash["ajxp_admin.scheduler."+e]||e}},{key:"changeParam",value:function(n,r){var e=this.props.job,e=(this.state.parameters||e.Parameters).map(function(e,t){return t===n?s.JobsJobParameter.constructFromObject(JSON.parse(JSON.stringify(r))):e});this.setState({parameters:e})}},{key:"save",value:function(){var n=this,e=this.props,r=e.job,e=e.onUpdate,o=void 0===e?function(){}:e,e=this.state.parameters;r.Parameters=e,ResourcesManager.loadClass("EnterpriseSDK").then(function(e){var t=e.SchedulerServiceApi,e=e.JobsPutJobRequest,t=new t(PydioApi.getRestClient()),e=new e;e.Job=s.JobsJob.constructFromObject(JSON.parse(JSON.stringify(r))),void 0!==e.Job.Tasks&&delete e.Job.Tasks,t.putJob(e).then(function(){o(),n.setState({open:!1,parameters:null,rand:Math.random()})}).catch(function(e){})}).catch(function(e){console.error("Cannot load specific library",e)})}},{key:"render",value:function(){var n=this,e=this.props.job,t=this.state,r=t.open,t=t.parameters,e=t||e.Parameters;return a.default.createElement(a.default.Fragment,null,a.default.createElement(l.FlatButton,{primary:!0,icon:a.default.createElement(l.FontIcon,{className:"mdi mdi-playlist-check"}),label:i.default.getMessages()["ajxp_admin.scheduler.job-parameters.button"],onClick:function(){return n.setState({open:!0})}}),a.default.createElement(l.Dialog,{title:i.default.getMessages()["ajxp_admin.scheduler.job-parameters.dialog"],open:r,modal:!0,onRequestClose:function(){return n.setState({open:!1})},actions:[a.default.createElement(l.FlatButton,{label:i.default.getMessages()[54],onClick:function(){return n.setState({open:!1})}}),a.default.createElement(l.FlatButton,{label:i.default.getMessages()[53],onClick:function(){return n.save()},disabled:!t})]},a.default.createElement("div",null,e.map(function(e,t){return a.default.createElement(S,{key:e.Name||"p-"+t,onChange:function(e){n.changeParam(t,e)},parameter:e,m:n.m.bind(n)})}))))}}]),n}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio",react:"react"}],5:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("react")),i=r(e("pydio")),l=r(e("pydio/http/resources-manager")),s=r(e("pydio/http/api")),u=e("cells-sdk"),c=e("material-ui"),d=r(e("./ScheduleForm"));function r(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,a["default"].Component);var e,t,n,r=m(o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t,e=(t=r.call(this,e)).props.job;return t.state={open:!1,job:e,rand:Math.random()},t}return e=o,(t=[{key:"updateJob",value:function(){var r=this,o=this.props.onUpdate,e=this.state,a=e.job,e=e.formState;e?("manual"===e.frequency?(void 0!==a.Schedule&&delete a.Schedule,a.AutoStart=!0):(a.Schedule={Iso8601Schedule:d.default.makeIso8601FromState(e)},void 0!==a.AutoStart&&delete a.AutoStart),l.default.loadClass("EnterpriseSDK").then(function(e){var t=e.SchedulerServiceApi,e=e.JobsPutJobRequest,t=new t(s.default.getRestClient()),n=new e;n.Job=u.JobsJob.constructFromObject(JSON.parse(JSON.stringify(a))),void 0!==n.Job.Tasks&&delete n.Job.Tasks,t.putJob(n).then(function(){o(),r.setState({open:!1,job:n.Job,rand:Math.random()})}).catch(function(e){})}).catch(function(e){console.error("Cannot load specific library",e)})):this.setState({open:!1})}},{key:"render",value:function(){var t=this,e=this.state,n=e.job,e=e.rand;return a.default.createElement("div",null,a.default.createElement(c.FlatButton,{primary:!0,icon:a.default.createElement(c.FontIcon,{className:"mdi mdi-timer"}),key:e,label:a.default.createElement(d.default,{schedule:n.Schedule,rand:e}),onClick:function(){t.setState({open:!0})}}),a.default.createElement(c.Dialog,{title:i.default.getMessages()["ajxp_admin.scheduler.schedule.title"],actions:[a.default.createElement(c.FlatButton,{label:i.default.getMessages()[54],onClick:function(){t.setState({open:!1})}}),a.default.createElement(c.FlatButton,{label:i.default.getMessages()[53],onClick:function(){t.updateJob()}})],modal:!1,open:this.state.open,contentStyle:{width:320}},a.default.createElement(d.default,{schedule:n.Schedule,onChangeState:function(e){t.setState({formState:e})},edit:!0,includeManual:!0})))}}])&&f(e.prototype,t),n&&f(e,n),o}();n.default=e,t.exports=n.default},{"./ScheduleForm":8,"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],6:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var y=a(e("react")),h=a(e("pydio")),d=a(e("./ScheduleForm")),f=a(e("./Events")),b=e("material-ui"),r=e("material-ui/styles"),p=a(e("./Loader"));function a(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function g(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(n);return e=r?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=h.default.requireLib("boot").moment,w=h.default.requireLib("components").MaterialTable,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(o,y["default"].Component);var e,t,n,r=c(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"extractRowsInfo",value:function(e,i){var l={color:"white",borderRadius:4,textAlign:"center",padding:4,overflow:"hidden",textOverflow:"ellipsis"},s=[],u=[],c=[];return void 0===e?{system:s,other:u}:(e.map(function(e){var t,n,r,o,a=g(g({},e),{},{SortEndTime:0,SortStatus:"UNKOWN"});void 0!==e.Tasks?(e.Tasks.sort(function(e,t){return e.StartTime&&t.StartTime&&e.StartTime!==t.StartTime?e.StartTime>t.StartTime?-1:1:e.ID>t.ID?1:-1}),r=e.Tasks[0],a.TaskStartTime=S(new Date(1e3*parseInt(r.StartTime))).fromNow(),r.EndTime?a.TaskEndTime=S(new Date(1e3*parseInt(r.EndTime))).fromNow():a.TaskEndTime="-",a.SortEndTime=r.EndTime||0,a.SortStatus=r.Status,"Finished"===r.Status?a.TaskStatus=r.Status:"Running"===r.Status?(t=e.Tasks.filter(function(e){return"Running"===e.Status}).length,a.TaskStatus=y.default.createElement("span",{style:{fontWeight:500,color:"#388e3c"}},t," tasks running")):"Error"===r.Status?a.TaskStatus=y.default.createElement("span",{style:{fontWeight:500,color:"#E53935"}},r.StatusMessage):"Queued"===r.Status?a.TaskStatus=y.default.createElement("span",{style:{fontWeight:500,color:"#fb8c00"}},r.StatusMessage):a.TaskStatus=y.default.createElement("span",null,r.Status," (",r.StatusMessage,")")):(a.TaskStatus="-",a.TaskEndTime="-",a.TaskStartTime="-"),e.Inactive&&(n={opacity:.43}),e.Schedule&&e.EventNames?(r=e.EventNames.map(function(e){return f.default.eventData(e).title}).join(", "),a.Trigger=y.default.createElement("div",{style:g(g(g({},l),n),{},{backgroundColor:"#03A9F4",backgroundImage:"-webkit-linear-gradient(-80deg, #03a9f4 50%, #43a047 50%)"})},y.default.createElement("span",{className:"mdi mdi-timer"})," ",y.default.createElement(d.default,{schedule:e.Schedule}),",",y.default.createElement("span",{title:r},y.default.createElement("span",{className:"mdi mdi-pulse",title:i("trigger.events")})," ",r)),a.SortValue="1-"+e.Label):e.EventNames&&p.default.canManualRun(e)?(o=[].concat(m(e.EventNames.map(function(e){return f.default.eventData(e).title})),[i("trigger.manual")]).join(", "),a.Trigger=y.default.createElement("div",{style:g(g(g({},l),n),{},{backgroundColor:"#03A9F4",backgroundImage:"-webkit-linear-gradient(-80deg, #03a9f4 50%, #607d8b 50%)"})},y.default.createElement("span",{title:o},y.default.createElement("span",{className:"mdi mdi-pulse",title:i("trigger.events")})," ",o)),a.SortValue="1-"+e.Label):e.Schedule?(a.Trigger=y.default.createElement("div",{style:g(g(g({},l),n),{},{backgroundColor:"#03A9F4"})},y.default.createElement("span",{className:"mdi mdi-timer"})," ",y.default.createElement(d.default,{schedule:e.Schedule})),a.SortValue="0-"+e.Label):e.EventNames?(o=e.EventNames.map(function(e){return f.default.eventData(e).title}).join(", "),a.SortValue="2-"+e.Label,a.Trigger=y.default.createElement("div",{style:g(g(g({},l),n),{},{backgroundColor:"#43a047"}),title:o},y.default.createElement("span",{className:"mdi mdi-pulse",title:i("trigger.events")})," ",o)):(a.Trigger=y.default.createElement("div",{style:g(g(g({},l),n),{},{backgroundColor:"#607d8b"})},y.default.createElement("span",{className:"mdi mdi-gesture-tap"})," ",i("trigger.manual")),a.SortValue="3-"+e.Label),e.Inactive?(a.TaskStartTime=y.default.createElement("span",{style:{opacity:.43}},a.TaskStartTime),a.TaskEndTime=y.default.createElement("span",{style:{opacity:.43}},a.TaskEndTime),a.TaskStatus=y.default.createElement("span",{style:{opacity:.43}},a.TaskStatus),c.push(a)):("pydio.system.user"===e.Owner?s:u).push(a)}),{system:s,other:u,inactives:c})}},{key:"render",value:function(){function t(e){return r.MessageHash["ajxp_admin.scheduler."+e]||e}var e=this,n=this.props,r=n.pydio,o=n.selectRows,a=n.muiTheme,i=n.jobs,l=void 0===i?[]:i,s=n.loading,u=n.jobsEditable,c=(this.state||{}).flowsOpen,d=AdminComponents.AdminStyles(a.palette),f=[{name:"Trigger",label:t("job.trigger"),style:{width:180,textAlign:"left",paddingRight:0},headerStyle:{width:180,paddingRight:0},hideSmall:!0,sorter:{type:"number",default:!0,value:function(e){return e.SortValue}}},{name:"Label",label:t("job.label"),style:{width:"40%",fontSize:15},headerStyle:{width:"40%"},sorter:{type:"string"}},{name:"TaskEndTime",label:t("job.endTime"),style:{width:"15%"},headerStyle:{width:"15%"},sorter:{type:"number",value:function(e){return e.SortEndTime}},hideSmall:!0},{name:"TaskStatus",label:t("job.status"),sorter:{type:"string",value:function(e){return e.SortStatus}}}],p=[].concat(f);p[0]={name:"Owner",label:t("job.owner"),style:{width:180},headerStyle:{width:180},hideSmall:!0},p[1]={name:"Label",label:t("job.label"),style:{width:"40%",fontSize:15},headerStyle:{width:"40%"},sorter:{type:"string"}};var m=[{name:"Trigger",label:t("job.trigger"),style:{width:180,textAlign:"left",paddingRight:0},headerStyle:{width:180,paddingRight:0},hideSmall:!0,sorter:{type:"number",default:!0,value:function(e){return e.SortValue}}},{name:"Label",label:t("job.label"),style:{fontSize:15},sorter:{type:"string",value:function(e){return e.Label}},renderCell:function(e){return y.default.createElement("span",{style:{color:"rgba(0,0,0,0.43)"}},"[",t("job.disabled"),"] ",e.Label)}}],i=this.extractRowsInfo(l,t),n=i.system,a=i.other,l=i.inactives,i=[{iconClassName:"mdi mdi-chevron-right",onClick:function(e){return o([e])}}];return y.default.createElement("div",{style:{flex:1,overflowY:"auto"}},y.default.createElement(AdminComponents.SubHeader,{title:t("system.title"),legend:t("system.legend")}),y.default.createElement(b.Paper,d.body.block.props,y.default.createElement(w,{data:n,columns:f,actions:i,onSelectRows:function(e){o(e)},showCheckboxes:!1,emptyStateString:s?h.default.getInstance().MessageHash[466]:t("system.empty"),masterStyles:d.body.tableMaster,storageKey:"console.scheduler.jobs.list"})),u&&y.default.createElement("div",{style:g(g({},d.body.block.container),{},{backgroundColor:"white",fontSize:15,display:"flex",alignItems:"center",cursor:"pointer"}),onClick:function(){e.setState({flowsOpen:!0})}},y.default.createElement(b.Dialog,{open:c,bodyStyle:{padding:0,minHeight:450},contentStyle:{maxWidth:622},onRequestClose:function(){return e.setState({flowsOpen:!1})},actions:[y.default.createElement(b.FlatButton,{label:r.MessageHash[54],onClick:function(){return e.setState({flowsOpen:!1})}}),y.default.createElement(b.FlatButton,{secondary:!0,label:t("cellsflows.dialog.button"),onClick:function(){window.open("https://pydio.com/en/pydio-cells/cells-flows?utm_source=cellsflows-app"),e.setState({flowsOpen:!1})}})]},y.default.createElement("img",{src:"/plug/access.settings/res/images/cellsflows.png",alt:"Cells Flows",style:{width:"100%"}}),y.default.createElement("div",{style:{fontSize:14,padding:"16px 20px",borderTop:"1px solid rgba(0, 0, 0, .1)",textAlign:"justify",color:"rgba(0,0,0,.73)"}},t("cellsflows.dialog.text"))),y.default.createElement("div",{style:{width:180,paddingLeft:24}},y.default.createElement(b.FlatButton,{label:t("cellsflows.cta.button"),disabled:!0,backgroundColor:"rgb(251, 251, 252)",style:{width:"100%",height:30,lineHeight:"30px"},secondary:!0,onClick:function(){}})),y.default.createElement("div",{style:{flex:1,padding:"16px 24px"}},t("cellsflows.cta.text")),y.default.createElement("div",{style:{fontSize:20,paddingRight:24,color:"rgba(0,0,0,.33)"}},y.default.createElement("span",{className:"mdi mdi-chevron-right"}))),y.default.createElement(AdminComponents.SubHeader,{title:t("users.title"),legend:t("users.legend")}),y.default.createElement(b.Paper,d.body.block.props,y.default.createElement(w,{data:a,columns:p,onSelectRows:function(e){o(e)},showCheckboxes:!1,emptyStateString:t("users.empty"),masterStyles:d.body.tableMaster,paginate:[25,50,100]})),l&&0<l.length&&y.default.createElement(y.default.Fragment,null,y.default.createElement(AdminComponents.SubHeader,{title:t("inactives.title"),legend:t("inactives.legend")}),y.default.createElement(b.Paper,d.body.block.props,y.default.createElement(w,{data:l,columns:m,actions:i,onSelectRows:function(e){o(e)},showCheckboxes:!1,masterStyles:d.body.tableMaster}))))}}])&&s(e.prototype,t),n&&s(e,n),o}(),e=(0,r.muiThemeable)()(e);n.default=e,t.exports=n.default},{"./Events":2,"./Loader":7,"./ScheduleForm":8,"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],7:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("pydio")),i=r(e("pydio/lang/observable")),l=r(e("lodash.debounce"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(n);return e=r?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=a.default.requireLib("boot").JobsStore,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(o,i["default"]);var e,t,n,r=c(o);function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).jobId=t,e}return e=o,n=[{key:"canManualRun",value:function(e){if(e.Schedule||!e.EventNames)return!0;var t=!1;try{e.Actions.forEach(function(e){e.TriggerFilter&&e.TriggerFilter.Query.SubQueries.forEach(function(e){e.value.IsManual&&(t=!0)})})}catch(e){}return t}}],(t=[{key:"start",value:function(){var e=this;this.load(!0),this._loadDebounced=(0,l.default)(function(){e.load(!0)},500),f.getInstance().observe("tasks_updated",this._loadDebounced),this._poll=setInterval(function(){a.default.getInstance().WebSocketClient.getStatus()&&e.load(!0)},5e3)}},{key:"stop",value:function(){this._poll&&(f.getInstance().stopObserving("tasks_updated",this._loadDebounced),clearInterval(this._poll))}},{key:"setFilter",value:function(e,t){this.owner=e,this.filter=t,this.load()}},{key:"load",value:function(){var t=this;0<arguments.length&&void 0!==arguments[0]&&arguments[0]||this.notify("loading"),this.jobId?f.getInstance().getAdminJobs(this.owner,null,this.jobId).then(function(e){e.Jobs&&0!==e.Jobs.length&&(e=e.Jobs[0],t.notify("loaded",{job:e}))}).catch(function(e){t.notify("loaded",{error:e.message})}):f.getInstance().getAdminJobs(this.owner,null,"",1).then(function(e){e=e.Jobs||[];t.notify("loaded",{jobs:e})}).catch(function(e){t.notify("loaded",{error:e.message})})}}])&&s(e.prototype,t),n&&s(e,n),o}();n.default=e,t.exports=n.default},{"lodash.debounce":"lodash.debounce",pydio:"pydio","pydio/lang/observable":"pydio/lang/observable"}],8:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var d=r(e("react")),a=r(e("pydio")),f=(e("cells-sdk"),e("material-ui"));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(n);return e=r?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=a.default.requireLib("boot").moment,e=a.default.requireLib("hoc"),h=e.ModernSelectField,b=e.ModernTextField,g=e.ModernStyles,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,d["default"].Component);var e,t,n,r=m(c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=r.call(this,e),e=e.schedule;return e?e.Iso8601Schedule?t.state=c.parseIso8601(e.Iso8601Schedule):t.state={frequency:"daily",daytime:new Date}:t.state=c.parseIso8601(""),t}return e=c,n=[{key:"parseIso8601",value:function(e){if(""===e||-1===e.indexOf("/"))return{frequency:"manual"};var t=i(e.split("/"),3),n=(t[0],t[1]),t=t[2],n=new Date(n);if("P1M"===t)return{frequency:"monthly",monthday:n.getDate(),daytime:n};if("P7D"===t)return{frequency:"weekly",weekday:y(n).day(),daytime:n};if("PT24H"===t||"P1D"===t)return{frequency:"daily",daytime:n};t=y.duration(t);return t.isValid()?{frequency:"timely",everyminutes:t.minutes()+60*t.hours()}:{error:"Cannot parse value "+e}}},{key:"makeIso8601FromState",value:function(e){var t=e.frequency,n=e.monthday,r=e.weekday,o=e.daytime,a=e.everyminutes,i=new Date("2012-01-01T00:00:00.828696-07:00"),l=y.duration(0);switch(t){case"manual":return"";case"monthly":o&&i.setTime(o.getTime()),i.setDate(n||1),l=y.duration(1,"months");break;case"weekly":o&&i.setTime(o.getTime());var s=y(i);s.day(void 0===r?1:r),i=s.toDate(),l=y.duration(7,"days");break;case"daily":o&&i.setTime(o.getTime()),l=y.duration(24,"hours");break;case"timely":l=y.duration(a,"minutes")}return"R/"+y(i).toISOString()+"/"+l.toISOString()}},{key:"readableString",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=e.frequency,o=e.monthday,a=e.weekday,i=e.daytime,l=e.everyminutes,s="0:00";switch(i&&(s=y(i).format("h:mm a")),r){case"manual":return t("trigger.manual");case"monthly":return n?t("schedule.monthly.short").replace("%1",o):t("schedule.monthly").replace("%1",o).replace("%2",s);case"weekly":return n?t("schedule.weekly.short").replace("%1",y.weekdays()[a]):t("schedule.weekly").replace("%1",y.weekdays()[a]).replace("%2",s);case"daily":return t(n?"schedule.daily.short":"schedule.daily").replace("%1",s);case"timely":var u=y.duration(l,"minutes");return t("schedule.timely").replace("%1",(u.hours()?u.hours()+"h":"")+(u.minutes()?u.minutes()+"mn":""));default:return"Error"}}}],(t=[{key:"onUpdate",value:function(){var e=this.props,t=e.schedule,n=e.onChange,e=e.onChangeState;e?e(this.state):(t.Iso8601Schedule=c.makeIso8601FromState(this.state),n(t))}},{key:"componentDidUpdate",value:function(e,t){t!==this.state&&this.onUpdate()}},{key:"T",value:function(e){return a.default.getMessages()["ajxp_admin.scheduler."+e]||e}},{key:"changeFrequency",value:function(e){var t=this.state,n=t.monthday,r=t.weekday,o=t.daytime,t=t.everyminutes;void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&((o=y()).year(2012),o.hours(9),o.minutes(0),o=o.toDate()),void 0===t&&(t=15),this.setState({frequency:e,monthday:n,weekday:r,daytime:o,everyminutes:t})}},{key:"render",value:function(){var r=this,e=this.props,t=e.edit,n=e.includeManual;if(!t)return d.default.createElement("span",null,c.readableString(this.state,this.T,!0));for(var o=this.state,a=o.frequency,i=o.monthday,l=o.weekday,e=o.daytime,t=o.everyminutes,s=[],o=y.weekdays(),u=1;u<30;u++)s.push(u);return d.default.createElement("div",null,d.default.createElement("div",{style:{padding:"10px 0",textAlign:"center"}},d.default.createElement("div",{style:{color:"#2196f3",fontSize:15,fontWeight:500}},c.readableString(this.state,this.T,!1)),"manual"!==a&&d.default.createElement("div",{style:{fontSize:11,paddingTop:5,color:"#e0e0e0"}},"ISO8601: ",c.makeIso8601FromState(this.state))),d.default.createElement(h,{floatingLabelText:this.T("schedule.type"),value:a,onChange:function(e,t,n){r.changeFrequency(n)},fullWidth:!0},n&&d.default.createElement(f.MenuItem,{value:"manual",primaryText:this.T("schedule.type.manual")}),d.default.createElement(f.MenuItem,{value:"monthly",primaryText:this.T("schedule.type.monthly")}),d.default.createElement(f.MenuItem,{value:"weekly",primaryText:this.T("schedule.type.weekly")}),d.default.createElement(f.MenuItem,{value:"daily",primaryText:this.T("schedule.type.daily")}),d.default.createElement(f.MenuItem,{value:"timely",primaryText:this.T("schedule.type.timely")})),"monthly"===a&&d.default.createElement("div",null,d.default.createElement(h,{floatingLabelText:this.T("schedule.detail.monthday"),value:i,onChange:function(e,t,n){r.setState({monthday:n})},fullWidth:!0},s.map(function(e){return d.default.createElement(f.MenuItem,{value:e,primaryText:e})}))),"weekly"===a&&d.default.createElement("div",null,d.default.createElement(h,{floatingLabelText:this.T("schedule.detail.weekday"),value:l,onChange:function(e,t,n){r.setState({weekday:n})},fullWidth:!0},o.map(function(e,t){return d.default.createElement(f.MenuItem,{value:t,primaryText:e})}))),("daily"===a||"monthly"===a||"weekly"===a)&&d.default.createElement("div",null,d.default.createElement(f.TimePicker,p({format:"ampm",minutesStep:5,hintText:this.T("schedule.detail.daytime"),value:e,onChange:function(e,t){r.setState({daytime:t})},fullWidth:!0},g.textField))),"timely"===a&&d.default.createElement("div",null,d.default.createElement(b,{floatingLabelText:this.T("schedule.detail.minutes"),value:t,type:"number",onChange:function(e,t){r.setState({everyminutes:parseInt(t)})},fullWidth:!0})))}}])&&s(e.prototype,t),n&&s(e,n),c}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio",react:"react"}],9:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=r(e("react")),a=r(e("pydio")),s=r(e("pydio/http/api")),d=e("material-ui"),u=e("cells-sdk"),i=r(e("lodash.debounce"));function r(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function m(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?p(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(n);return e=r?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=a.default.requireLib("components").MaterialTable,e=a.default.requireLib("boot"),S=e.JobsStore,w=e.moment,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(o,c["default"].Component);var e,t,n,r=b(o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t=r.call(this,e),n=a.default.getInstance().Parameters.get("backend").ServerOffset,e=60*(new Date).getTimezoneOffset();return t.state={activity:[],loading:!1,page:0,serverOffset:n+e,timeOffset:0},t}return e=o,(t=[{key:"toggleTimeOffset",value:function(){var e=this.state,t=e.timeOffset,e=e.serverOffset;this.setState({timeOffset:t?0:e})}},{key:"componentDidMount",value:function(){var t=this;this.loadActivity(this.props),this._loadDebounced=(0,i.default)(function(e){e&&t.props.task&&t.props.task.JobID===e&&t.loadActivity(t.props,0,4)},500),S.getInstance().observe("tasks_updated",this._loadDebounced);var e=this.props.poll;e&&(this._interval=window.setInterval(function(){a.default.getInstance().WebSocketClient.getStatus()&&t.loadActivity(t.props,t.state&&t.state.page?t.state.page:0,4)},e))}},{key:"componentWillUnmount",value:function(){this._loadDebounced&&S.getInstance().stopObserving("tasks_updated",this._loadDebounced),this._interval&&window.clearInterval(this._interval)}},{key:"componentWillReceiveProps",value:function(e){this.props.task||this.loadActivity(e),e.task&&this.props.task&&e.task.ID!==this.props.task.ID&&this.loadActivity(e)}},{key:"loadActivity",value:function(t){var e,n,r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=t.task,l=t.poll;i&&(e=i.JobID+"-"+i.ID.substr(0,8),n=new u.JobsServiceApi(s.default.getRestClient()),(i=new u.LogListLogRequest).Query='+OperationUuid:"'+e+'"',i.Page=o,i.Size=200,i.Format=u.ListLogRequestLogFormat.constructFromObject("JSON"),this.setState({loading:!0}),n.listTasksLogs(i).then(function(e){e=e.Logs||[];r.setState({activity:e,loading:!1,page:o}),!e.length&&a<3&&!l&&setTimeout(function(){return r.loadActivity(t,o,a+1)},2e3)}).catch(function(){r.setState({activity:[],loading:!1,page:o})}))}},{key:"computeTag",value:function(e){var t,n=this.props,r=n.job,o=n.descriptions,n={backgroundColor:"#1e96f3",fontSize:11,fontWeight:500,color:"white",padding:"0 8px",overflow:"hidden",textOverflow:"ellipsis",borderRadius:4,textAlign:"center"},a=e.SchedulerTaskActionPath;if(!a)return null;if("ROOT"===a)return c.default.createElement("div",{style:m(m({},n),{},{backgroundColor:"white",color:"rgba(0,0,0,.87)",border:"1px solid #e0e0e0"})},"Trigger");try{t=this.findAction(a,r.Actions)}catch(e){}return t?t.Label?a=t.Label:o&&o[t.ID]&&(a=o[t.ID].Label):(e=a.split("/").pop().split("$").shift(),o&&o[e]&&(a=o[e].Label)),c.default.createElement("div",{style:n},a)}},{key:"findAction",value:function(e,t){var n=e.split("/"),e=(n.shift(),l(n).shift()),t=t[parseInt(e.split("$")[1])],e=-1===e.indexOf("$FAIL")?t.ChainedActions:t.FailedFilterActions;return 1<n.length?this.findAction(n.join("/"),e):t}},{key:"render",value:function(){var t=this,e=this.props,n=e.pydio,r=e.onRequestClose,o=this.state,a=o.activity,i=o.loading,l=o.page,s=o.serverOffset,e=o.timeOffset,u=void 0===e?0:e,o="#f5f5f5",e=[{name:"SchedulerTaskActionPath",label:"",hideSmall:!0,style:{width:110,height:32,backgroundColor:o,paddingLeft:12,paddingRight:0,userSelect:"text"},headerStyle:{width:110,paddingLeft:12,paddingRight:0},renderCell:function(e){return t.computeTag(e)}},{name:"Ts",label:n.MessageHash["settings.17"],style:{width:100,height:32,backgroundColor:o,paddingRight:10,userSelect:"text"},headerStyle:{width:100,paddingRight:10},renderCell:function(e){return w(1e3*(e.Ts+u)).format("HH:mm:ss")}},{name:"Msg",label:n.MessageHash["ajxp_admin.logs.message"],style:{height:32,backgroundColor:o,userSelect:"text"}}];return c.default.createElement("div",{style:{paddingTop:12,paddingBottom:10,backgroundColor:o}},c.default.createElement("div",{style:{padding:"0 24px 10px",fontWeight:500,backgroundColor:o,display:"flex",alignItems:"center"}},c.default.createElement("div",null,n.MessageHash["ajxp_admin.scheduler.tasks.activity.title"]),c.default.createElement("div",{style:{flex:1,textAlign:"center",fontSize:20,display:"flex",alignItems:"center",justifyContent:"center"}},0<l&&c.default.createElement(d.FontIcon,{className:"mdi mdi-chevron-left",color:"rgba(0,0,0,.7)",style:{cursor:"pointer"},onClick:function(){t.loadActivity(t.props,l-1)}}),(0<l||200<=a.length)&&c.default.createElement("span",{style:{fontSize:12}},n.MessageHash[331]," ",i?c.default.createElement(d.CircularProgress,{size:16,thickness:1.5}):c.default.createElement("span",null,l+1)),200<=a.length&&c.default.createElement(d.FontIcon,{className:"mdi mdi-chevron-right",color:"rgba(0,0,0,.7)",style:{cursor:"pointer"},onClick:function(){t.loadActivity(t.props,l+1)}})),0!==s&&c.default.createElement("div",{style:{paddingRight:15,cursor:"pointer"},onClick:function(){return t.toggleTimeOffset()}},c.default.createElement(d.FontIcon,{className:"mdi mdi-alarm"+(u?"-snooze":""),color:"rgba(0,0,0,.3)",style:{fontSize:16}})),c.default.createElement("div",{style:{paddingRight:15,cursor:"pointer"},onClick:r},c.default.createElement(d.FontIcon,{className:"mdi mdi-close",color:"rgba(0,0,0,.3)",style:{fontSize:16}}))),c.default.createElement(v,{hideHeaders:!0,columns:e,data:a,showCheckboxes:!1,emptyStateString:i?c.default.createElement("div",{style:{display:"flex",alignItems:"center"}}," ",c.default.createElement(d.CircularProgress,{size:16,thickness:1.5})," ",c.default.createElement("span",{style:{flex:1,marginLeft:5}},n.MessageHash["ajxp_admin.scheduler.tasks.activity.loading"])):n.MessageHash["ajxp_admin.scheduler.tasks.activity.empty"],emptyStateStyle:{backgroundColor:o},computeRowStyle:function(e){return{borderBottomColor:"#fff",height:32}}}))}}])&&y(e.prototype,t),n&&y(e,n),o}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","lodash.debounce":"lodash.debounce","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],10:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var d=a(e("react")),r=a(e("pydio")),f=e("material-ui"),l=a(e("./TaskActivity"));function a(e){return e&&e.__esModule?e:{default:e}}function i(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function s(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=r.default.requireLib("boot"),h=e.JobsStore,b=e.SingleJobProgress,g=e.moment,v=r.default.requireLib("components").MaterialTable,r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,d["default"].Component);var e,t,n,r=m(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,e)).state={mode:"log",selectedRows:[],working:!1,taskLogs:null},e}return e=o,(t=[{key:"renderActions",value:function(e){function t(e){return n.MessageHash["ajxp_admin.scheduler.task.action."+e]||e}var n=this.props.pydio,r=h.getInstance(),o=[],a={iconStyle:{color:"rgba(0,0,0,.3)"}};return"Running"===e.Status&&e.CanPause&&o.push(d.default.createElement(f.IconButton,u({iconClassName:"mdi mdi-pause",tooltip:t("pause"),onClick:function(){r.controlTask(e,"Pause")}},a))),"Paused"===e.Status&&o.push(d.default.createElement(f.IconButton,u({iconClassName:"mdi mdi-play",tooltip:t("resume"),onClick:function(){r.controlTask(e,"Resume")}},a))),"Running"===e.Status||"Paused"===e.Status?e.CanStop?o.push(d.default.createElement(f.IconButton,u({iconClassName:"mdi mdi-stop",tooltip:t("stop"),onClick:function(){r.controlTask(e,"Stop")}},a))):"Pending"===e.StatusMessage&&o.push(d.default.createElement(f.IconButton,u({iconClassName:"mdi mdi-delete",tooltip:t("delete"),onClick:function(){r.controlTask(e,"Delete")}},a))):o.push(d.default.createElement(f.IconButton,u({iconClassName:"mdi mdi-delete",tooltip:t("delete"),onClick:function(){r.controlTask(e,"Delete")}},a))),o}},{key:"onSelectTaskRows",value:function(e){"selection"===this.state.mode?this.setState({selectedRows:e}):1===e.length&&this.setState({taskLogs:e[0]})}},{key:"setLoading",value:function(e){var t=this.props.onLoading;this.setState({working:e}),t&&t(e)}},{key:"deleteSelection",value:function(){var e=this,t=this.state.selectedRows,n=this.props.job,r=h.getInstance();this.setLoading(!0),r.deleteTasks(n.ID,t).then(function(){e.setState({selectedRows:[],mode:"log"}),e.setLoading(!1)}).catch(function(){e.setLoading(!1)})}},{key:"deleteAll",value:function(){var e=this,t=this.props,n=t.pydio,r=t.job;n.UI.openConfirmDialog({message:n.MessageHash["ajxp_admin.scheduler.tasks.delete.confirm"],validCallback:function(){e.setLoading(!0),h.getInstance().deleteAllTasksForJob(r.ID).then(function(){e.setLoading(!1)}).catch(function(){e.setLoading(!1)})}})}},{key:"insertTaskLogRow",value:function(e){var n=this,t=this.props,r=t.pydio,o=t.job,t=t.descriptions,a=void 0===t?[]:t,t=this.state,i=t.taskLogs;return"selection"===t.mode?e:e.map(function(e){if(i&&e.ID===i.ID){var t=d.default.createElement(l.default,{pydio:r,task:i,job:o,descriptions:a,onRequestClose:function(){n.setState({taskLogs:null})},poll:"Running"===e.Status?1050:void 0});return s(s({},e),{},{expandedRow:t})}return e})}},{key:"render",value:function(){var t=this,e=this.props,n=e.pydio,r=e.adminStyles,o=e.job,a=this.state,i=a.selectedRows,l=a.working,s=a.mode;if(!o)return null;var e=function(e){return n.MessageHash["ajxp_admin.scheduler."+e]||e},a=d.default.createElement("div",{style:{lineHeight:"initial",marginLeft:5}},d.default.createElement(f.IconButton,{iconClassName:"mdi mdi-delete-sweep",iconStyle:{color:"rgba(0,0,0,.3)"},tooltip:e("tasks.bulk.clear"),primary:!0,onClick:this.deleteAll.bind(this),disabled:l})),a=[{name:"ID",label:d.default.createElement("div",{style:{display:"flex",alignItems:"center",marginLeft:-20}},d.default.createElement("div",{style:{lineHeight:"initial",marginLeft:5}},d.default.createElement(f.IconButton,{iconClassName:"mdi mdi-checkbox-multiple-"+("selection"===s?"marked":"blank")+"-outline",iconStyle:{color:"rgba(0,0,0,.3)"},tooltip:e("selection"===s?"tasks.bulk.disable":"tasks.bulk.enable"),primary:!0,onClick:function(){t.setState({mode:"selection"===s?"log":"selection",taskLogs:null})},disabled:l})),d.default.createElement("span",null,e("task.id"))),hideSmall:!0,style:{width:110,fontSize:15,paddingLeft:20},headerStyle:{width:110,paddingLeft:20},renderCell:function(e){return e.ID.substr(0,8)}},{name:"StartTime",style:{width:100,paddingRight:10},headerStyle:{width:100,paddingRight:10},label:e("task.start"),renderCell:function(e){e=g(1e3*e.StartTime),e=e.isSame(Date.now(),"day")?e.format("HH:mm:ss"):e.fromNow();return e}},{name:"StatusMessage",label:e("task.message"),hideSmall:!0,renderCell:function(e){return"Error"===e.Status?d.default.createElement("span",{style:{fontWeight:500,color:"#E53935"}},e.StatusMessage):"Running"===e.Status?d.default.createElement(b,{pydio:n,jobID:e.JobID,taskID:e.ID}):e.StatusMessage}},{name:"EndTime",style:{width:100},headerStyle:{width:100},label:e("task.duration"),hideSmall:!0,renderCell:function(e){var t=g(Date.now()),n=(t=e.EndTime?g(1e3*e.EndTime):t).diff(g(1e3*e.StartTime)),t=g.utc(n),e=t.format("H"),n=t.format("m"),t=t.format("s");return"0"===e&&"0"===n&&"0"===t?"< 1s":("0"===e?"":e+"h:")+("0"===e&&"0"===n?"":n+"mn:")+t+"s"}},{name:"Actions",label:a,style:{textAlign:"right",width:120,paddingLeft:0},headerStyle:{width:120,paddingLeft:0,paddingRight:20,textAlign:"right"},renderCell:this.renderActions.bind(this)}],o=o.Tasks||[],u=["Running","Paused"];o.sort(function(e,t){return e.StartTime&&t.StartTime&&e.StartTime!==t.StartTime?e.StartTime>t.StartTime?-1:1:e.ID>t.ID?1:-1});var c=o.filter(function(e){return-1!==u.indexOf(e.Status)}),c=this.insertTaskLogRow(c),o=o.filter(function(e){return-1===u.indexOf(e.Status)}),o=this.insertTaskLogRow(o);return d.default.createElement("div",null,0<c.length&&d.default.createElement(AdminComponents.SubHeader,{title:e("tasks.running")}),0<c.length&&d.default.createElement(f.Paper,r.body.block.props,d.default.createElement(v,{data:c,columns:a,hideHeaders:!0,showCheckboxes:!1,emptyStateString:e("tasks.running.empty"),onSelectRows:function(e){1===e.length&&c.length&&t.setState({taskLogs:e[0]})},masterStyles:r.body.tableMaster})),d.default.createElement(AdminComponents.SubHeader,{title:d.default.createElement("div",{style:{display:"flex",width:"100%",alignItems:"baseline"}},d.default.createElement("div",{style:{flex:1}},e("tasks.history")),"selection"===s&&1<i.length&&d.default.createElement("div",{style:{lineHeight:"initial"}},d.default.createElement(f.RaisedButton,{label:e("tasks.bulk.delete"),secondary:!0,onClick:this.deleteSelection.bind(this),disabled:l})))}),d.default.createElement(f.Paper,r.body.block.props,d.default.createElement(v,{data:o,columns:a,showCheckboxes:"selection"===s,onSelectRows:this.onSelectTaskRows.bind(this),emptyStateString:e("tasks.history.empty"),selectedRows:i,deselectOnClickAway:!0,masterStyles:r.body.tableMaster,paginate:[10,25,50,100],defaultPageSize:10})))}}])&&c(e.prototype,t),n&&c(e,n),o}();n.default=r,t.exports=n.default},{"./TaskActivity":9,"material-ui":"material-ui",pydio:"pydio",react:"react"}],11:[function(e,t,n){"use strict";var r=s(e("./board/Dashboard")),o=s(e("./board/JobsList")),a=s(e("./board/TasksList")),i=s(e("./board/ScheduleForm")),l=s(e("./board/Events")),e=s(e("./board/Loader"));function s(e){return e&&e.__esModule?e:{default:e}}window.AdminScheduler={Dashboard:r.default,JobsList:o.default,TasksList:a.default,ScheduleForm:i.default,Events:l.default,Loader:e.default}},{"./board/Dashboard":1,"./board/Events":2,"./board/JobsList":6,"./board/Loader":7,"./board/ScheduleForm":8,"./board/TasksList":10}]},{},[11]);