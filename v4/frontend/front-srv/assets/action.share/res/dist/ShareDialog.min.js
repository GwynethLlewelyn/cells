!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ShareDialog=e()}(function(){return function o(r,i,a){function l(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return l(r[t][1][e]||e)},n,n.exports,o,r,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(r){var e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,c.Component);var n,o,e=(n=t,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=u(n);return e=o?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e});function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.apply(this,arguments)}return function(e,t,n){t&&l(e.prototype,t);n&&l(e,n)}(t,[{key:"render",value:function(){var e=this.context,t=e.messages,n=e.getMessage,e=e.isReadonly;return c.createElement(r,a({},this.props,{messages:t,getMessage:n,isReadonly:e}))}}]),t}();return e.contextTypes={messages:o.object,getMessage:o.func,isReadonly:o.func},e};var o=e("prop-types"),c=e("react");t.exports=n.default},{"prop-types":"prop-types",react:"react"}],2:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var g=i(e("react")),o=i(e("pydio")),v=i(e("./EditCellDialog")),a=i(e("pydio/model/cell")),l=i(e("pydio/http/resources-manager")),O=e("material-ui"),s=i(e("../main/ShareHelper"));function i(e){return e&&e.__esModule?e:{default:e}}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(n);return e=o?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=o.default.requireLib("components"),k=o.GenericCard,E=o.GenericLine,P=o.QuotaUsageLine,o=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(i,g["default"].Component);var e,t,n,r=f(i);function i(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this,e)).state={edit:!1,model:new a.default,loading:!0},n._observer=function(){n.forceUpdate()},l.default.loadClassesAndApply(["PydioActivityStreams","PydioCoreActions"],function(){n.setState({extLibs:!0})});var o=n.props.rootNode;return o&&(o.getMetadata().has("virtual_root")?o.isLoaded()?(n.state.rootNodes=[],o.getChildren().forEach(function(e){return n.state.rootNodes.push(e)})):(o.observe("loaded",function(){var t=[];o.getChildren().forEach(function(e){return t.push(e)}),n.setState({rootNodes:t})}),o.load()):n.state.rootNodes=[o]),n}return e=i,(t=[{key:"componentDidMount",value:function(){var t=this,e=this.props,n=e.pydio,e=e.cellId;n.user.activeRepository===e?n.user.getActiveRepositoryAsCell().then(function(e){t.setState({model:e,loading:!1}),e.observe("update",t._observer)}):(this.state.model.observe("update",function(){t.setState({loading:!1}),t.forceUpdate()}),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){s.default.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){var e,t=this,n=this.props,o=n.mode,r=n.pydio,i=n.editorOneColumn,a=this.state,l=a.edit,s=a.model,u=a.extLibs,c=a.rootNodes,f=a.loading,n=function(e){return r.MessageHash["share_center."+e]},a={width:350,minHeight:270};if(l)a=i?{width:350,height:500}:{width:700,height:500},e=g.default.createElement(v.default,w({},this.props,{model:s,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:i}));else if(s){var d,p,y,i=(i=s.getRootNodes().map(function(e){return s.getNodeLabelInContext(e)}).join(", "))||s.getRootNodes().length+" item(s)";"infoPanel"!==o&&(y=[],s.getUuid()!==r.user.activeRepository&&y.push(g.default.createElement(O.MenuItem,{primaryText:n(246),onClick:function(){r.triggerRepositoryChange(s.getUuid()),t.props.onDismiss()}})),s.isEditable()&&(d=function(){s.deleteCell().then(function(e){t.props.onDismiss()})},p=function(){t.setState({edit:!0}),t.props.onHeightChange&&t.props.onHeightChange(500)},y.push(g.default.createElement(O.MenuItem,{primaryText:n(247),onClick:function(){return t.setState({edit:!0})}})),y.push(g.default.createElement(O.MenuItem,{primaryText:n(248),onClick:d}))));var h,m,b=[];if(u&&c&&!f&&(m=g.default.createElement(PydioActivityStreams.WatchSelector,{pydio:r,nodes:c}),h=g.default.createElement(E,{iconClassName:"mdi mdi-bell-outline",legend:r.MessageHash["meta.watch.selector.legend"],data:m,iconStyle:{marginTop:32}}),m=g.default.createElement(PydioCoreActions.BookmarkButton,{pydio:r,nodes:c,styles:{iconStyle:{color:"white"}}})),c&&!f&&c.forEach(function(e){e.getMetadata().get("ws_quota")&&b.push(g.default.createElement(P,{node:e}))}),e=g.default.createElement(k,{pydio:r,title:s.getLabel(),onDismissAction:this.props.onDismiss,otherActions:m,onDeleteAction:d,onEditAction:p,editColor:"#009688",headerSmall:"infoPanel"===o,moreMenuItems:y},!f&&s.getDescription()&&g.default.createElement(E,{iconClassName:"mdi mdi-information",legend:n(145),data:s.getDescription()}),g.default.createElement(E,{iconClassName:"mdi mdi-account-multiple",legend:n(54),data:s.getAclsSubjects(),placeHolder:!0,placeHolderReady:!f}),g.default.createElement(E,{iconClassName:"mdi mdi-folder",legend:n(249),data:i,placeHolder:!0,placeHolderReady:!f}),b,"infoPanel"!==o&&(h||g.default.createElement(E,{placeHolder:!0,placeHolderReady:!f}))),"infoPanel"===o)return e}return g.default.createElement(O.Paper,{zDepth:0,style:a},e)}}])&&u(e.prototype,t),n&&u(e,n),i}();n.default=o,t.exports=n.default},{"../main/ShareHelper":29,"./EditCellDialog":4,"material-ui":"material-ui",pydio:"pydio","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/cell":"pydio/model/cell",react:"react"}],3:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=d(e("react")),o=d(e("prop-types")),i=d(e("pydio")),u=e("material-ui"),a=e("material-ui/styles"),c=d(e("./SharedUsers")),f=d(e("./NodesPicker")),l=d(e("pydio/model/cell"));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(n);return e=o?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?m(t):e}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=i.default.requireLib("hoc").ModernTextField,i=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(r,s["default"].Component);var e,t,n,o=h(r);function r(){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(m(a=o.call.apply(o,[this].concat(t))),"state",{step:"users",model:new l.default,saving:!1}),g(m(a),"submit",function(){var e=a.state.model;a.setState({saving:!0}),e.save().then(function(e){a.props.onDismiss(),a.setState({saving:!1})}).catch(function(e){pydio.UI.displayMessage("ERROR",e.message),a.setState({saving:!1})})}),g(m(a),"m",function(e){return a.props.pydio.MessageHash["share_center."+e]}),g(m(a),"computeSummaryString",function(){var e=a.state.model,t=0,n=0,o=0,r=[],i=e.getAcls();return Object.keys(i).map(function(e){e=i[e];e.Group?n++:e.Role?o++:t++}),t&&r.push(t+" "+a.m(270)),n&&r.push(n+" "+a.m(271)),o&&r.push(o+" "+a.m(272)),r=3===r.length?r[0]+", "+r[1]+a.m(274)+r[3]:0===r.length?a.m(273):r.join(a.m(274)),a.m(269).replace("%USERS",r)}),a}return e=r,(t=[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.refs.title.focus(),this.state.model.observe("update",function(){e.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e,t=this,n=[],o=this.props.pydio,r=this.state,i=r.step,a=r.model,l=r.saving,r=o.MessageHash[418];return"users"!==i&&(r=a.getLabel()),"users"===i?(e=s.default.createElement("div",null,s.default.createElement("div",null,this.m(275)),s.default.createElement(v,{ref:"title",floatingLabelText:this.m(276),value:a.getLabel(),onChange:function(e,t){a.setLabel(t)},fullWidth:!0}),s.default.createElement(v,{floatingLabelText:this.m(277),value:a.getDescription(),onChange:function(e,t){a.setDescription(t)},fullWidth:!0})),a.getLabel()&&(n.push(s.default.createElement(u.FlatButton,{key:"quick",primary:!0,disabled:!a.getLabel()||l,label:this.m("cells.create.advanced"),onClick:function(){t.setState({step:"data"})}})),n.push(s.default.createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),n.push(s.default.createElement(u.RaisedButton,{key:"next1",disabled:!a.getLabel()||l,primary:!0,label:this.m(279),onClick:function(){t.submit()}}))):"data"===i?(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m(278)),s.default.createElement(c.default,{pydio:o,cellAcls:a.getAcls(),excludes:[o.user.id],onUserObjectAdd:a.addUser.bind(a),onUserObjectRemove:a.removeUser.bind(a),onUserObjectUpdateRight:a.updateUserRight.bind(a)})),n.push(s.default.createElement(u.FlatButton,{key:"prev1",primary:!1,label:o.MessageHash[304],onClick:function(){t.setState({step:"users"})}})),n.push(s.default.createElement(u.FlatButton,{key:"next2",primary:!0,label:o.MessageHash[179],onClick:function(){return t.setState({step:"label"})}}))):(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),s.default.createElement("div",{style:{color:"#9e9e9e"}},this.computeSummaryString()),s.default.createElement("div",{style:{paddingTop:16}},s.default.createElement(f.default,{pydio:o,model:a}))),n.push(s.default.createElement(u.FlatButton,{key:"prev2",primary:!1,label:o.MessageHash[304],onClick:function(){t.setState({step:"data"})}})),n.push(s.default.createElement(u.RaisedButton,{key:"submit",disabled:l,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),s.default.createElement("div",{style:{width:380,fontSize:13,color:"rgba(0,0,0,.87)",display:"flex",flexDirection:"column",minHeight:300}},s.default.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},s.default.createElement(u.FontIcon,{className:"icomoon-cells-full-plus"}),s.default.createElement("div",{style:{padding:20,fontSize:22}},r)),s.default.createElement("div",{style:{padding:"20px 20px 10px",flex:1}},e),s.default.createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},n))}}])&&p(e.prototype,t),n&&p(e,n),r}();g(n.default=i,"childContextTypes",{messages:o.default.object,getMessage:o.default.func,isReadonly:o.default.func}),n.default=i=(0,a.muiThemeable)()(i),t.exports=n.default},{"./NodesPicker":5,"./SharedUsers":7,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/model/cell":"pydio/model/cell",react:"react"}],4:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=u(e("./SharedUsers")),l=u(e("./NodesPicker")),s=u(e("../main/GenericEditor")),o=u(e("prop-types")),i=u(e("pydio"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=o?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?p(t):e}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e("react"),b=i.default.requireLib("components").ResourcePoliciesPanel,g=i.default.requireLib("hoc").ModernTextField,i=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,m.Component);var e,t,n,o=d(i);function i(){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h(p(r=o.call.apply(o,[this].concat(t))),"submit",function(){var e=r.props,t=e.model,n=e.pydio,o=t.hasDirtyRootNodes();t.save().then(function(e){r.forceUpdate(),o&&t.getUuid()===n.user.getActiveRepository()&&(n.goTo("/"),n.fireContextRefresh())}).catch(function(e){n.UI.displayMessage("ERROR",e.message)})}),r}return e=i,(t=[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.model,o=e.sendInvitations,r=function(e){return t.MessageHash["share_center."+e]},e=m.createElement("div",null,m.createElement(g,{floatingLabelText:r(267),value:n.getLabel(),onChange:function(e,t){n.setLabel(t)},fullWidth:!0}),m.createElement(g,{floatingLabelText:r(268),value:n.getDescription(),onChange:function(e,t){n.setDescription(t)},fullWidth:!0})),r={leftStyle:{padding:10},rightStyle:{padding:10},left:[{Label:r(54),Value:"users",Component:m.createElement(a.default,{pydio:t,cellAcls:n.getAcls(),excludes:[t.user.id],sendInvitations:o,onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n)})},{Label:r(253),Value:"permissions",AlwaysLast:!0,Component:m.createElement(b,{pydio:t,resourceType:"cell",description:r("cell.visibility.advanced"),resourceId:n.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:n.getAcls()})}],right:[{Label:r(249),Value:"content",Component:m.createElement(l.default,{pydio:t,model:n,mode:"edit"})}]};return m.createElement(s.default,{pydio:t,tabs:r,header:e,editorOneColumn:this.props.editorOneColumn,saveEnabled:n.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){n.revertChanges()}})}}])&&c(e.prototype,t),n&&c(e,n),i}();h(n.default=i,"childContextTypes",{messages:o.default.object,getMessage:o.default.func,isReadonly:o.default.func}),t.exports=n.default},{"../main/GenericEditor":27,"./NodesPicker":5,"./SharedUsers":7,"prop-types":"prop-types",pydio:"pydio",react:"react"}],5:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=i(e("react")),f=e("material-ui"),o=e("material-ui/styles"),d=i(e("pydio/model/data-model"));function i(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=o?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=e("pydio").requireLib("components").FoldersTree,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(u,c["default"].Component);var e,t,n,s=h(u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=s.call(this,e),n=e.pydio.user,o=[];n.getRepositoriesList().forEach(function(e){if("gateway"===e.getAccessType()){if(e.getId()===n.activeRepository){if("shared"===e.getOwner())return;r=e}o.push(e)}});var r,i,a=[],l=o.filter(function(e){return!e.getOwner()}),e=o.filter(function(e){return e.getOwner()});return(a=l.length&&e.length?[].concat(p(l),["DIVIDER"],p(e)):[].concat(p(l),p(e))).length&&(r=r||a[0],(e=(i=d.default.RemoteDataModelFactory({tmp_repository_id:r.getId()})).getRootNode()).getMetadata().set("repository_id",r.getId()),e.load(i.getAjxpNodeProvider())),t.state={dataModel:i,open:!1,availableWs:a,crtWs:r},t}return e=u,(t=[{key:"switchWorkspace",value:function(e){var t=d.default.RemoteDataModelFactory({tmp_repository_id:e.getId()}),n=t.getRootNode();n.getMetadata().set("repository_id",e.getId()),n.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,e=e.crtWs;this.props.model.addRootNode(t,e.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var t=this.props.model;return c.default.createElement(f.ListItem,{disabled:!0,leftIcon:c.default.createElement(f.FontIcon,{className:"mdi mdi-"+("LEAF"===e.Type?"file":"folder")}),primaryText:t.getNodeLabelInContext(e),rightIconButton:c.default.createElement(f.IconButton,{onClick:function(){t.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"rgba(0,0,0,.43)"}})})}},{key:"render",value:function(){function e(e){return l.MessageHash["share_center."+e]}var t,o=this,n=this.props,r=n.model,i=n.muiTheme,a=n.mode,l=n.pydio,s=r.getRootNodes()||[],u=[];s.map(function(e){u.push(o.renderNodeLine(e)),u.push(c.default.createElement(f.Divider,{inset:!0}))}),u.pop(),s.length||"edit"===a&&(t=c.default.createElement("span",{style:{color:"rgba(0,0,0,.54)",fontStyle:"italic"}},e(280)));n="edit"===a?c.default.createElement(f.FlatButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!0,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus"})}):c.default.createElement(f.RaisedButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!1,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),r=this.state,s=r.node,a=r.availableWs,r=r.crtWs;return c.default.createElement("div",null,n,c.default.createElement(f.List,null,u),t,c.default.createElement(f.Popover,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},c.default.createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},c.default.createElement(f.DropDownMenu,{style:{height:54},value:r,onChange:function(e,t,n){o.switchWorkspace(n)}},a.map(function(e){return"DIVIDER"===e?c.default.createElement(f.Divider,null):c.default.createElement(f.MenuItem,{value:e,primaryText:e.getLabel()})})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15,color:"rgba(0,0,0,.73)"}},c.default.createElement(m,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15}},s&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.87)"}},s&&s.getPath()),!s&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.54)",fontWeight:500}},e(283)),c.default.createElement(f.IconButton,{iconStyle:{color:i.palette.primary1Color},disabled:!s,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}])&&l(e.prototype,t),n&&l(e,n),u}();n.default=e,n.default=e=(0,o.muiThemeable)()(e),t.exports=n.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],6:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=e("material-ui"),f=i(e("./UserBadge")),o=i(e("../ShareContextConsumer"));function i(e){return e&&e.__esModule?e:{default:e}}function a(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=o?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?p(t):e}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e("prop-types"),b=e("react"),e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(i,b.Component);var e,t,n,r=u(i);function i(){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return h(p(n=r.call.apply(r,[this].concat(t))),"onRemove",function(){n.props.onUserObjectRemove(n.props.cellAcl.RoleId)}),h(p(n),"onInvite",function(){var e={},t=PydioUsers.User.fromIdmUser(n.props.cellAcl.User);e[t.getId()]=t,n.props.sendInvitations(e)}),h(p(n),"onUpdateRight",function(e,t){n.props.onUserObjectUpdateRight(n.props.cellAcl.RoleId,e,t)}),n}return e=i,(t=[{key:"render",value:function(){var e,t,n=this,o=this.props,r=o.cellAcl,i=o.pydio,a=[],l=r.User?"user":r.Group?"group":"team";if(r.User&&r.User.Login===i.user.id)return null;switch("group"!=l&&this.props.sendInvitations&&a.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||a.push({text:this.props.getMessage("257",""),callback:this.onRemove}),l){case"user":e=r.User.Attributes.displayName||r.User.Login,t=r.User.Attributes.avatar;break;case"group":e=r.Group.Attributes?r.Group.Attributes.displayName||r.Group.GroupLabel:r.Group.Uuid;break;case"team":e=r.Role?r.Role.Label:"No role found";break;default:e=r.RoleId}var s=!1,u=!1;r.Actions.map(function(e){"read"===e.Name&&(s=!0),"write"===e.Name&&(u=!0)});o=this.props.isReadonly()||this.props.readonly,i={display:"flex",width:70};a.length||(i=d(d({},i),{},{marginRight:48}));o=b.createElement("span",{style:i},b.createElement(c.Checkbox,{disabled:o,checked:s,onCheck:function(e,t){n.onUpdateRight("read",t)}}),b.createElement(c.Checkbox,{disabled:o,checked:u,onCheck:function(e,t){n.onUpdateRight("write",t)}}));return b.createElement(f.default,{label:e,avatar:t,type:l,menus:a,boxes:o})}}])&&l(e.prototype,t),n&&l(e,n),i}();h(n.default=e,"propTypes",{cellAcl:m.object.isRequired,sendInvitations:m.func,onUserObjectRemove:m.func.isRequired,onUserObjectUpdateRight:m.func.isRequired}),n.default=e=(0,o.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"./UserBadge":8,"material-ui":"material-ui","prop-types":"prop-types",react:"react"}],7:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var f=l(e("react")),o=l(e("../ShareContextConsumer")),d=l(e("./SharedUserEntry")),p=l(e("../main/ActionButton")),i=l(e("prop-types")),a=l(e("pydio"));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=o?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?y(t):e}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=a.default.requireLib("components").UsersCompleter,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(i,f["default"].Component);var e,t,n,o=c(i);function i(){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m(y(r=o.call.apply(o,[this].concat(t))),"sendInvitationToAllUsers",function(){var e=r.props,t=e.cellAcls,n=e.pydio,o=[];Object.keys(t).map(function(e){e=t[e];e.User&&e.User.Login===n.user.id||e.User&&(e=PydioUsers.User.fromIdmUser(e.User),o[e.getId()]=e)}),r.props.sendInvitations(o)}),m(y(r),"clearAllUsers",function(){Object.keys(r.props.cellAcls).map(function(e){r.props.onUserObjectRemove(e)})}),m(y(r),"valueSelected",function(e){e.IdmUser?r.props.onUserObjectAdd(e.IdmUser):r.props.onUserObjectAdd(e.IdmRole)}),r}return e=i,(t=[{key:"render",value:function(){var t=this,e=this.props,n=e.cellAcls,o=e.pydio,r=e.completerStyle,i=o.getPluginConfigs("core.auth"),a=0,l=[];Object.keys(n).map(function(e){e=n[e];e.User&&e.User.Login===o.user.id||(a++,l.push(f.default.createElement(d.default,{cellAcl:e,key:a,pydio:t.props.pydio,readonly:t.props.readonly,sendInvitations:t.props.sendInvitations,onUserObjectRemove:t.props.onUserObjectRemove,onUserObjectUpdateRight:t.props.onUserObjectUpdateRight})))});var s,u,c=[],e=Object.keys(this.props.cellAcls).length;return!e||this.props.isReadonly()||this.props.readonly||c.push(f.default.createElement(p.default,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"account-minus",messageId:"180"})),e&&this.props.sendInvitations&&c.push(f.default.createElement(p.default,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&1<e&&!this.props.isReadonly()&&!this.props.readonly&&c.push(f.default.createElement(p.default,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0})),this.props.withActionLinks&&(c=this.props.withActionLinks(c)),l.length&&(s=f.default.createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:"rgba(0,0,0,.33)",fontSize:12}},f.default.createElement("div",{style:{flex:1}}),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("361",""))),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("181"))),f.default.createElement("div",{style:{width:6}}))),this.props.isReadonly()||this.props.readonly||(u=Object.values(n).map(function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null}).filter(function(e){return!!e}),u=f.default.createElement(b,{className:"share-form-users",fieldLabel:this.props.getMessage("34"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:u,existingOnly:!i.get("USER_CREATE_USERS")})),f.default.createElement("div",null,f.default.createElement("div",{style:r||{margin:"0 8px 16px"}},u),s,f.default.createElement("div",null,l),!l.length&&f.default.createElement("div",{style:{color:"rgba(0,0,0,0.43)",fontWeight:500,margin:"0 10px"}},this.props.getMessage("182")),0<l.length&&f.default.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},c))}}])&&s(e.prototype,t),n&&s(e,n),i}();m(n.default=e,"propTypes",{pydio:i.default.instanceOf(a.default),cellAcls:i.default.object,saveSelectionAsTeam:i.default.func,sendInvitations:i.default.func,showTitle:i.default.bool,onUserObjectAdd:i.default.func.isRequired,onUserObjectRemove:i.default.func.isRequired,onUserObjectUpdateRight:i.default.func.isRequired}),n.default=e=(0,o.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"../main/ActionButton":26,"./SharedUserEntry":6,"prop-types":"prop-types",pydio:"pydio",react:"react"}],8:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=o?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("prop-types"),u=e("react").Component,c=e("material-ui"),f=c.MenuItem,d=c.IconMenu,p=c.IconButton,c=e("material-ui/styles").muiThemeable,y=e("color"),e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(r,u);var e,t,n,o=l(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.apply(this,arguments)}return e=r,(t=[{key:"renderMenu",value:function(){if(!this.props.menus||!this.props.menus.length)return null;var e=this.props.menus.map(function(e){var t;return e.checked&&(t=React.createElement("span",{className:"mdi mdi-check"})),React.createElement(f,{primaryText:e.text,onClick:e.callback,rightIcon:t})});return React.createElement(d,{iconButtonElement:React.createElement(p,{style:{width:30,height:30,padding:5},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},desktop:!0},e)}},{key:"render",value:function(){var e=this.props.muiTheme.palette.avatarsColor,t="group"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple",style:{backgroundColor:e}})):"team"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple-outline",style:{backgroundColor:e}})):"temporary"===this.props.type?(e=y(e).lighten(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-plus",style:{backgroundColor:e}})):"remote_user"===this.props.type?React.createElement("span",{className:"avatar mdi mdi-account-network",style:{backgroundColor:e}}):React.createElement("span",{className:"avatar mdi mdi-account",style:{backgroundColor:e}}),n=this.renderMenu(),e=this.props.boxes;return React.createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},t,React.createElement("span",{className:"user-badge-label"},this.props.label),n,e)}}])&&i(e.prototype,t),n&&i(e,n),r}();(n.default=e).propTypes={label:o.string,avatar:o.string,type:o.string,menus:o.object,muiTheme:o.object},n.default=e=c()(e),t.exports=n.default},{color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],9:[function(p,y,h){!function(d){!function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var b=t(p("react")),i=t(p("../composite/CompositeModel")),g=t(p("../main/GenericEditor")),e=t(p("pydio")),v=t(p("../links/Panel")),O=(t(p("../links/SecureOptions")),t(p("../main/ShareHelper"))),w=t(p("./Mailer")),k=t(p("./NewCellsList")),a=t(p("clipboard")),E=(t(p("../links/PublicLinkTemplate")),t(p("../links/VisibilityPanel"))),P=t(p("../links/LabelPanel"));p("material-ui");function t(e){return e&&e.__esModule?e:{default:e}}function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function n(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function l(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(n);return e=o?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=e.default.requireLib("hoc").PaletteModifier,_=e.default.requireLib("boot").Tooltip,e=e.default.requireLib("components"),C=e.GenericCard,M=e.GenericLine,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,b["default"].Component);var e,t,n,o=c(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,e)).state={mode:e.props.mode||"view",model:new i.default("edit"===e.props.mode)},e}return e=r,(t=[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,n=t.pydio,t=t.onDismiss;e.isDirty()&&!confirm(n.MessageHash["share_center.dialog.close.confirm.unsaved"])||t()}},{key:"attachClipboard",value:function(){function n(e){return o.MessageHash["share_center."+e]}var t,o=this.props.pydio,e=this.state.model;this.detachClipboard(),!e.getLinks().length||(t=e.getLinks()[0]).getLink()&&this.refs["copy-button"]&&(this._clip=new a.default(this.refs["copy-button"],{text:function(e){return O.default.buildPublicUrl(o,t.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:n("192")},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)),this._clip.on("error",function(){var e=this,t=0===d.navigator.platform.indexOf("Mac")?n(144):n(143);this.setState({copyMessage:t},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)))}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,t=t.mode;this.state.model.observe("update",function(){e.forceUpdate()}),this.state.model.load(n,"infoPanel"===t),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){O.default.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=O.default.prepareEmail(this.props.node,e);this.setState({mailerData:l(l({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"deleteAllShares",value:function(){var e=this.props.pydio,t=this.state.model;e.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{dialogTitleId:"share_center.composite.deleteAll",message:e.MessageHash["share_center.255"],validCallback:function(){t.stopObserving("update"),t.deleteAll().then(function(e){t.updateUnderlyingNode()})}})}},{key:"render",value:function(){var e,t=this,n=this.props,o=n.node,r=n.mode,i=n.pydio,a=n.editorOneColumn,l=n.popoverPanel,s=n.popoverRequestClose,u=this.state,c=u.model,f=u.mailerData,d=u.linkTooltip,p=u.copyMessage,n=function(e){return i.MessageHash["share_center."+e]};if("edit"===r){c.getLinks().length&&(e=c.getLinks()[0]);var y=b.default.createElement("div",{style:{fontSize:20,padding:10}},b.default.createElement(w.default,S({},f,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),o&&n(256).replace("%s",o.getLabel())),h={left:[],right:[]},u=!1;c.getCells().filter(function(e){return e.getUuid()}).length&&(u=!0),h.right.push({Label:n(254)+(u?" (active)":""),Value:"cells",Icon:"mdi mdi-account-multiple",Component:b.default.createElement(k.default,{pydio:i,compositeModel:c,usersInvitations:this.usersInvitations.bind(this)})});f=c.getLinks();return e&&(u=!(o=[]),e.getLinkUuid()&&(u=!0,o.push({title:n("151"),content:b.default.createElement(P.default,{pydio:i,linkModel:f[0],model:c})}),f[0].isEditable()&&o.push({title:n("253"),content:b.default.createElement(E.default,{pydio:i,linkModel:f[0]})})),h.left.push({Label:n(121)+(u?" (active)":""),Value:"public-link",Icon:"mdi mdi-link",Component:b.default.createElement(v.default,{pydio:i,compositeModel:c,linkModel:f[0],showMailer:O.default.mailerSupported(i)?this.linkInvitation.bind(this):null,additionalPanes:o})})),b.default.createElement(g.default,{tabs:h,pydio:i,header:y,saveEnabled:c.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return t.confirmAndDismiss()},onRevertAction:function(){c.revertChanges()},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:350,color:"rgba(0,0,0,.83)",fontSize:13}})}var h=[],m=[];c.getCells().map(function(e){m.push(e.getLabel())});y=c.getLinks();return y.length&&((a=y[0]).hasError()?(y=a.hasError(),h.push(b.default.createElement(M,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:y.Detail||y.Msg||y}))):a.getLink()&&a.getLink().LinkHash&&(a=O.default.buildPublicUrl(i,a.getLink(),"infoPanel"===r),h.push(b.default.createElement(M,{iconClassName:"mdi mdi-link",legend:n(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:b.default.createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){t.setState({linkTooltip:!0})},onMouseOut:function(){t.setState({linkTooltip:!1})}},b.default.createElement(_,{label:p||n(191),horizontalPosition:"left",verticalPosition:"top",show:d}),a)})))),m.length&&h.push(b.default.createElement(M,{iconClassName:"mdi mdi-account-multiple",legend:n(254),data:m.join(", ")})),b.default.createElement(C,{pydio:i,title:i.MessageHash["share_center.50"],onDismissAction:this.props.onDismiss,onDeleteAction:function(){s&&s(),t.deleteAllShares()},onEditAction:function(){s&&s(),i.Controller.fireAction("share-edit-shared")},editTooltip:i.MessageHash["share_center.125"],deleteTooltip:i.MessageHash["share_center.composite.deleteAll"],headerSmall:"infoPanel"===r,popoverPanel:l,popoverRequestClose:s},h,!h.length&&b.default.createElement(M,{placeHolder:!0}))}}])&&s(e.prototype,t),n&&s(e,n),r}();h.default=e,h.default=e=o({primary1Color:"#009688"})(e),y.exports=h.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"./NewCellsList":13,clipboard:"clipboard","material-ui":"material-ui",pydio:"pydio",react:"react"}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(e("./CompositeCard")),r=l(e("pydio/model/data-model")),i=l(e("prop-types")),a=l(e("pydio"));function l(e){return e&&e.__esModule?e:{default:e}}var s=e("react"),i=e("create-react-class")({displayName:"CompositeDialog",mixins:[e("pydio").requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"md+"}},propTypes:{pydio:i.default.instanceOf(a.default).isRequired,selection:i.default.instanceOf(r.default),readonly:i.default.bool},childContextTypes:{messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func},getChildContext:function(){var e=this,n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return e.props.readonly}}},shouldComponentUpdate:function(e,t){return!!this.props.selection.getUniqueNode()},render:function(){var e,t=this.props,n=t.pydio,t=t.selection;return t.getUniqueNode()&&(e=t.getUniqueNode()),s.createElement(o.default,{editorOneColumn:!0,pydio:n,mode:"edit",node:e,onDismiss:this.props.onDismiss})}});n.default=i,t.exports=n.default},{"./CompositeCard":9,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],11:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("pydio/lang/observable")),a=o(e("../links/LinkModel")),l=o(e("../main/ShareHelper")),s=o(e("pydio/model/cell")),u=e("cells-sdk"),c=o(e("pydio"));function o(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(n);return e=o?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?h(t):e}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=c.default.requireLib("boot").moment,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,i["default"]);var e,t,n,o=y(r);function r(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),b(h(e=o.call(this)),"cells",void 0),b(h(e),"links",void 0),b(h(e),"edit",void 0),b(h(e),"node",void 0),b(h(e),"saving",void 0),e.cells=[],e.links=[],e.edit=t,e}return e=r,(t=[{key:"emptyLink",value:function(e){var t=this,n=new a.default,o=new u.TreeNode,r=l.default.getAuthorizations();o.Uuid=e.getMetadata().get("uuid"),n.getLink().Label=e.getLabel(),n.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",g(new Date).format("YYYY/MM/DD")),n.getLink().RootNodes.push(o);var i,o=[u.RestShareLinkAccessType.constructFromObject("Download")];return e.isLeaf()?(i="pydio_unique_dl",l.default.nodeHasEditor(pydio,e).preview&&!r.max_downloads?(i="pydio_unique_strip",o.push(u.RestShareLinkAccessType.constructFromObject("Preview"))):0<r.max_downloads&&(n.getLink().MaxDownloads=r.max_downloads)):(i="pydio_shared_folder",o.push(u.RestShareLinkAccessType.constructFromObject("Preview"))),n.getLink().ViewTemplateName=i,n.getLink().Permissions=o,r.max_expiration&&(n.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(r.max_expiration)*60*24)),n.observe("update",function(){t.notify("update")}),n.observe("save",function(){t.updateUnderlyingNode()}),n}},{key:"createEmptyCell",value:function(){var e=this,t=new s.default(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",function(){e.notify("update")}),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,n=new s.default(!0);n.observe("update",function(){t.notify("update")}),n.load(e).then(function(){n.addRootNode(t.node)});e=this.cells.filter(function(e){return!e.getUuid()});e.length&&this.removeNewCell(e[0]),this.cells.push(n)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||c.default.getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then(function(e){t.updateUnderlyingNode()})}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map(function(e){var t;3===e.Scope?((t=new a.default).observe("update",function(){n.notify("update")}),t.observe("save",function(){n.updateUnderlyingNode()}),t.load(e.UUID),n.links.push(t)):2===e.Scope&&((t=new s.default).observe("update",function(){n.notify("update")}),t.load(e.UUID),n.cells.push(t))}),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),this.edit&&this.canCreateCells()&&!this.cells.length&&this.createEmptyCell(),t&&this.node.observe("node_replaced",function(){n.load(n.node,!1)})}},{key:"loadUniqueLink",value:function(e,t){var n=this;this.node=t;t=new a.default;return t.observe("update",function(){n.notify("update")}),t.load(e),this.links.push(t),t}},{key:"canCreateCells",value:function(){if(!this.node)return!1;var e=l.default.getAuthorizations(),t=this.node.isLeaf();return t&&e.file_workspaces||!t&&e.folder_workspaces}},{key:"save",value:function(){var n=this;this.saving=!0,this.notify("update");var t=[];this.cells.map(function(e){e.isDirty()&&t.push(e.save())}),this.links.map(function(e){e.isDirty()&&t.push(e.save())}),Promise.all(t).then(function(){var t=n.node.getMetadata().get("uuid");n.cells=n.cells.filter(function(e){return e.hasRootNode(t)}),n.updateUnderlyingNode(),n.saving=!1}).catch(function(e){n.updateUnderlyingNode(),n.saving=!1})}},{key:"deleteAll",value:function(){var t=this.node.getMetadata().get("uuid"),n=[];return this.cells.map(function(e){e.removeRootNode(t),n.push(e.save())}),this.links.map(function(e){n.push(e.deleteLink())}),Promise.all(n)}},{key:"removeNewCell",value:function(t){this.cells=this.cells.filter(function(e){return e!==t}),this.notify("update")}},{key:"revertChanges",value:function(){this.cells=this.cells.filter(function(e){return e.getUuid()}),this.cells.map(function(e){e.isDirty()&&e.revertChanges()}),this.links.map(function(e){e.isDirty()&&e.revertChanges()}),this.notify("update")}},{key:"isDirty",value:function(){return!this.saving&&this.cells.filter(function(e){return e.isDirty()}).length||this.links.filter(function(e){return e.isDirty()}).length}},{key:"stopObserving",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.cells.map(function(e){e.stopObserving("update")}),this.links.map(function(e){e.stopObserving("update")}),d(m(r.prototype),"stopObserving",this).call(this,e,t)}},{key:"getCells",value:function(){if(this.node){var t=this.node.getMetadata().get("uuid");return this.cells.filter(function(e){return e.hasRootNode(t)})}return this.cells}},{key:"getLinks",value:function(){return this.links}}])&&f(e.prototype,t),n&&f(e,n),r}();n.default=e,t.exports=n.default},{"../links/LinkModel":18,"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/lang/observable":"pydio/lang/observable","pydio/model/cell":"pydio/model/cell"}],12:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("react")),a=o(e("pydio/http/resources-manager")),l=o(e("../main/ShareHelper")),d=(e("material-ui"),e("cells-sdk"));function o(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function u(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function c(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=o?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,i["default"].Component);var e,t,n,o=y(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,e)).state={mailerData:null},e}return e=r,(t=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.subject,o=e.message,r=(e.users,e.linkModel),i=e.templateId;e.templateData;n||i?l.default.forceMailerOldSchool()?(n=encodeURIComponent(n),location.href="mailto:custom-email@domain.com?Subject="+n+"&Body="+o):a.default.loadClassesAndApply(["PydioMailer"],function(){t.setState({mailerData:c(c({},e),{},{enableIdentification:r&&r.getLink().TargetUsers,identifiedOnly:r&&r.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0})})}):this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:c(c({},this.state.mailerData),e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,n,i,a,t,l){var o=this.state.mailerData,r=o.crippleIdentificationKeys,s=o.identifiedOnly,u=o.linkModel,c=u.getLink();c.TargetUsers||(c.TargetUsers={}),c.RestrictToTargetUsers=s;var f={};Object.keys(n).forEach(function(e){var t=r?Math.random().toString(36).substring(7):e;c.TargetUsers[t]=d.RestShareLinkTargetUser.constructFromObject({Display:n[e].getLabel(),DownloadCount:0}),f[t]=e}),u.updateLink(c),u.save().then(function(){var n=new e,o=u.getPublicUrl(),r=new RegExp(o,"g");Object.keys(f).forEach(function(e){var t=a.replace(r,o+"?u="+e);n.addTarget(f[e],i,t)}),n.post(function(e){l(e)})})}},{key:"getMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){if(this.state.mailerData){var e,t=this.state.mailerData;return i.default.createElement(PydioMailer.Pane,s({},t,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:e,processPost:t.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto"}}))}return null}}])&&f(e.prototype,t),n&&f(e,n),r}();n.default=e,t.exports=n.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk","material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],13:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var y=s(e("react")),o=s(e("./CompositeModel")),h=s(e("../cells/SharedUsers")),i=s(e("prop-types")),a=s(e("pydio")),l=e("material-ui/styles"),m=e("material-ui");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(n);return e=o?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(r,y["default"].Component);var e,t,n,o=f(r);function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=o.call(this,e),n=null;return 0===e.compositeModel.getCells().length&&(n="NEWCELL"),t.state={edit:n},t}return e=r,(t=[{key:"addToCellsMenuItems",value:function(){var e,t,n,o=this,r=[],i=this.props,a=i.pydio,l=i.compositeModel,s=l.getCells().map(function(e){return e.getUuid()});return 0===s.filter(function(e){return!e}).length&&(r.push(y.default.createElement(m.MenuItem,{primaryText:"Create new Cell",onClick:function(){o.setState({addMenuOpen:!1}),l.createEmptyCell()},leftIcon:y.default.createElement(m.FontIcon,{className:"icomoon-cells-full-plus"})})),e=!0),a.user.getRepositoriesList().forEach(function(e){"shared"===e.getOwner()&&-1===s.indexOf(e.getId())&&(r.push(y.default.createElement(m.MenuItem,{primaryText:e.getLabel(),onClick:function(){o.setState({addMenuOpen:!1}),l.addToExistingCell(e.getId())},leftIcon:y.default.createElement(m.FontIcon,{className:"icomoon-cells"})})),t=!0)}),t&&e?n="Add to existing or new Cell":t?n="Add to existing Cell":e&&(n="Create a new Cell"),{addItems:r,addLabel:n}}},{key:"removeCurrentNodeFromCell",value:function(t){var e=this.props.compositeModel;0===e.getCells().filter(function(e){return e!==t}).length&&e.createEmptyCell(),t.removeRootNode(e.getNode().getMetadata().get("uuid"))}},{key:"render",value:function(){function i(e){return s.MessageHash["share_center."+e]}var a=this,e=this.props,l=e.compositeModel,s=e.pydio,u=e.usersInvitations,t=e.muiTheme,c=this.state.edit;if(l.getNode()&&!l.canCreateCells())return y.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.43)",padding:8}},i(l.getNode().isLeaf()?"227":"228"));var f,n,o,d=1<l.getCells().length,p=[];l.getCells().map(function(t){function e(){var e;r&&"NEWCELL"===c&&(e=t.getAcls(),Object.keys(e).length||l.removeNewCell(t)),a.setState({edit:r?null:t.getUuid()})}var n,o=t.getLabel(),r=!t.getUuid()&&"NEWCELL"===c||c===t.getUuid()||!d;r?n=y.default.createElement(m.IconButton,{iconClassName:"mdi mdi-close",tooltip:s.MessageHash[86],onClick:e}):t.isEditable()&&(n=y.default.createElement(m.IconMenu,{iconButtonElement:y.default.createElement(m.IconButton,{iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"}},y.default.createElement(m.MenuItem,{primaryText:i(258),onClick:e}),y.default.createElement(m.MenuItem,{primaryText:i(259),onClick:function(){t.removeRootNode(l.getNode().getMetadata().get("uuid"))}}))),d?p.push(y.default.createElement(m.ListItem,{primaryText:o,secondaryText:t.getAclsSubjects(),rightIconButton:n,onClick:e,disabled:"NEWCELL"===c&&!r})):t.getUuid()&&(f=t),r&&p.push(y.default.createElement(m.Paper,{zDepth:0,style:{padding:0,margin:10}},y.default.createElement(h.default,{pydio:s,cellAcls:t.getAcls(),excludes:[s.user.id],onUserObjectAdd:t.addUser.bind(t),onUserObjectRemove:t.removeUser.bind(t),onUserObjectUpdateRight:t.updateUserRight.bind(t),sendInvitations:function(e){return u(e,t)},saveSelectionAsTeam:!1,readonly:!t.isEditable(),completerStyle:{margin:"-6px 8px 16px"}}))),p.push(y.default.createElement(m.Divider,null))}),p.pop(),d?o="Shared in multiple cells":f?(o=y.default.createElement("span",null,"Shared in ",y.default.createElement("span",{style:{fontWeight:500,color:t.palette.accent2Color}},f.getLabel())),n=y.default.createElement(m.Toggle,{toggled:!0,iconClassName:"icomoon-cells-full-minus",iconStyle:{color:t.palette.accent2Color},tooltip:"Remove from this cell",tooltipPosition:"bottom-left",onToggle:function(){a.removeCurrentNodeFromCell(f)}})):o="Share with specific users or groups";var r,e=this.addToCellsMenuItems(),t=e.addItems,e=e.addLabel;return t.length&&(r=this.props.muiTheme,r=y.default.createElement("span",null,y.default.createElement(m.FlatButton,{iconClassName:"icomoon-cells-full-plus",style:{width:"100%"},iconStyle:{color:r.palette.accent2Color},primary:!0,tooltip:i(263),label:e,tooltipPosition:"bottom-left",onClick:function(e){a.setState({addMenuOpen:!0,addMenuAnchor:e.currentTarget})}}),y.default.createElement(m.Popover,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){a.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"middle",vertical:"bottom"},targetOrigin:{horizontal:"middle",vertical:"top"}},y.default.createElement(m.Menu,{desktop:!0,listStyle:{paddingTop:0}},y.default.createElement(m.Subheader,null,"Add to new or existing Cell"),t)))),y.default.createElement("div",{style:this.props.style},y.default.createElement("div",{style:{display:"none",alignItems:"center",backgroundColor:"rgb(246, 246, 248)",borderBottom:"0px solid rgb(224, 224, 224)",fontSize:15}},y.default.createElement("div",{style:{flex:1,padding:15,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},o),n&&y.default.createElement("div",null,n),y.default.createElement("div",{style:{width:10}})),y.default.createElement(m.List,{style:{minHeight:300}},p),r&&y.default.createElement("div",{style:{borderTop:"1px solid #e0e0e0",padding:"20px 16px"}},r))}}])&&u(e.prototype,t),n&&u(e,n),r}();(n.default=e).PropTypes={pydio:i.default.instanceOf(a.default),compositeModel:i.default.instanceOf(o.default).isRequired,usersInvitations:i.default.func},n.default=e=(0,l.muiThemeable)()(e),t.exports=n.default},{"../cells/SharedUsers":7,"./CompositeModel":11,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react"}],14:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=o(e("react")),i=o(e("../composite/CompositeModel")),f=o(e("../main/GenericEditor")),d=o(e("../links/Panel")),p=o(e("../links/SecureOptions")),y=o(e("../main/ShareHelper")),h=o(e("./Mailer")),m=o(e("../links/PublicLinkTemplate")),b=o(e("../links/VisibilityPanel")),g=o(e("../links/LabelPanel")),v=e("material-ui");function o(e){return e&&e.__esModule?e:{default:e}}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function a(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function l(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=k(n);return e=o?(e=k(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=e("pydio").requireLib("hoc").PaletteModifier,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,c["default"].Component);var e,t,n,o=w(r);function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),e.editorOneColumn=!0;var t=o.call(this,e),e=new i.default(!0);return e.skipUpdateUnderlyingNode=!0,t.state={mode:t.props.mode||"view",model:e},t}return e=r,(t=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,o=t.linkUuid,r=t.onRemoveLink,t=this.state.model;t.observe("update",function(){e.forceUpdate()}),t.loadUniqueLink(o,n).observeOnce("delete",function(){r&&r()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=y.default.prepareEmail(this.props.node,e);this.setState({mailerData:l(l({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){function e(e){return i.MessageHash["share_center."+e]}var t,n,o=this.props,r=o.node,i=o.pydio,a=o.editorOneColumn,l=this.state,s=l.model,u=l.mailerData,o=(t=s.getLinks().length?s.getLinks()[0]:t)&&t.getLinkUuid()&&t.isEditable()?c.default.createElement("div",null,c.default.createElement(h.default,O({},u,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),c.default.createElement(g.default,{pydio:i,linkModel:t})):c.default.createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},c.default.createElement(h.default,O({},u,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),e(256).replace("%s",r.getLabel())),l={left:[],right:[],leftStyle:{padding:0}},u=s.getLinks();return t&&(l.left.push({Label:e(251),Value:"public-link",Component:c.default.createElement(d.default,{pydio:i,compositeModel:s,linkModel:u[0],showMailer:y.default.mailerSupported(i)?this.linkInvitation.bind(this):null})}),t.getLinkUuid()&&(1<(r=y.default.compileLayoutData(i,s)).length&&(n=c.default.createElement(m.default,{linkModel:t,pydio:i,layoutData:r,style:{padding:"10px 16px"},readonly:s.getNode().isLeaf()})),l.left.push({Label:e(252),Value:"link-secure",Component:c.default.createElement("div",null,c.default.createElement(p.default,{pydio:i,linkModel:u[0]}),n&&c.default.createElement(v.Divider,null),n)}),l.left.push({Label:e(253),Value:"link-visibility",Component:c.default.createElement(b.default,{pydio:i,linkModel:u[0]}),AlwaysLast:!0}))),c.default.createElement(f.default,{tabs:l,pydio:i,header:o,saveEnabled:s.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){s.revertChanges()},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}])&&s(e.prototype,t),n&&s(e,n),r}();n.default=e,n.default=e=E({primary1Color:"#009688"})(e),t.exports=n.default},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"material-ui":"material-ui",pydio:"pydio",react:"react"}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"CreateCellDialog",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"EditCellDialog",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"CellCard",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"SimpleLinkCard",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"InfoPanel",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"CompositeDialog",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"LinkModel",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"ShareHelper",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"ShareView",{enumerable:!0,get:function(){return f.ShareView}}),Object.defineProperty(n,"ShareViewModal",{enumerable:!0,get:function(){return f.ShareViewModal}});var o=d(e("./cells/CreateCellDialog")),r=d(e("./cells/EditCellDialog")),i=d(e("./cells/CellCard")),a=d(e("./composite/SimpleLinkCard")),l=d(e("./main/InfoPanel")),s=d(e("./composite/CompositeDialog")),u=d(e("./links/LinkModel")),c=d(e("./main/ShareHelper")),f=e("./lists/ShareView");function d(e){return e&&e.__esModule?e:{default:e}}},{"./cells/CellCard":2,"./cells/CreateCellDialog":3,"./cells/EditCellDialog":4,"./composite/CompositeDialog":10,"./composite/SimpleLinkCard":14,"./links/LinkModel":18,"./lists/ShareView":25,"./main/InfoPanel":28,"./main/ShareHelper":29}],16:[function(S,_,C){!function(P){!function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var l=y(S("react")),e=y(S("pydio")),t=y(S("prop-types")),n=y(S("../ShareContextConsumer")),s=(y(S("./TargetedUsers")),S("material-ui")),u=y(S("qrcode.react")),a=y(S("clipboard")),c=y(S("../main/ActionButton")),f=y(S("pydio/util/path")),d=y(S("pydio/util/lang")),o=S("material-ui/styles"),p=y(S("../main/ShareHelper")),i=y(S("./LinkModel"));function y(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(n);return e=o?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?v(t):e}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=e.default.requireLib("hoc").ModernStyles,E=e.default.requireLib("boot").Tooltip,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(i,l["default"].Component);var e,t,n,r=g(i);function i(){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(v(o=r.call.apply(r,[this].concat(t))),"state",{editLink:!1,copyMessage:"",showQRCode:!1}),w(v(o),"toggleEditMode",function(){var e=o.props,t=e.linkModel,n=e.pydio;if(o.state.editLink&&o.state.customLink){e=p.default.getAuthorizations();if(e.hash_min_length&&o.state.customLink.length<e.hash_min_length)return void n.UI.displayMessage("ERROR",o.props.getMessage("223").replace("%s",e.hash_min_length));t.setCustomLink(o.state.customLink),t.save()}o.setState({editLink:!o.state.editLink,customLink:void 0})}),w(v(o),"changeLink",function(e){e=e.target.value,e=d.default.computeStringSlug(e);o.setState({customLink:e})}),w(v(o),"clearCopyMessage",function(){P.setTimeout(function(){this.setState({copyMessage:""})}.bind(v(o)),5e3)}),w(v(o),"attachClipboard",function(){var e=o.props,t=e.linkModel,n=e.pydio;o.detachClipboard(),o.refs["copy-button"]&&(o._clip=new a.default(o.refs["copy-button"],{text:function(e){return p.default.buildPublicUrl(n,t.getLink())}.bind(v(o))}),o._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(v(o))),o._clip.on("error",function(){var e=0===P.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143");this.refs["public-link-field"].focus(),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(v(o))))}),w(v(o),"detachClipboard",function(){o._clip&&o._clip.destroy()}),w(v(o),"openMailer",function(){o.props.showMailer(o.props.linkModel)}),w(v(o),"toggleQRCode",function(){o.setState({showQRCode:!o.state.showQRCode})}),o}return e=i,(t=[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"render",value:function(){var e=this,t=this.props,n=t.linkModel,o=t.pydio,r=p.default.buildPublicUrl(o,n.getLink()),i=p.default.getAuthorizations(),a=this.props.editAllowed&&i.editable_hash&&!this.props.isReadonly()&&n.isEditable();if(this.state.editLink&&a)return l.default.createElement("div",null,l.default.createElement("div",{style:{display:"flex",alignItems:"center",backgroundColor:"rgb(246, 246, 248)",padding:6,borderRadius:2}},l.default.createElement("span",{style:{fontSize:16,color:"rgba(0,0,0,0.4)",display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},f.default.getDirname(r)+"/ "),l.default.createElement(s.TextField,{style:{flex:1,marginRight:10,marginLeft:10},onChange:this.changeLink,value:void 0!==this.state.customLink?this.state.customLink:n.getLink().LinkHash}),l.default.createElement(c.default,{mdiIcon:"check",callback:this.toggleEditMode})),l.default.createElement("div",{style:{textAlign:"center",fontSize:13,color:"rgba(0,0,0,0.43)",paddingTop:16}},this.props.getMessage("194")));t=this.state,o=t.copyMessage,i=t.linkTooltip,function(){return{__html:this.state.copyMessage}}.bind(this),n=[],t=this.props.muiTheme;return n.push(l.default.createElement("div",{key:"copy",ref:"copy-button",style:{position:"relative",display:"inline-block",width:36,height:36,padding:"8px 10px",margin:"0 6px",cursor:"pointer",borderRadius:"50%",border:"1px solid "+t.palette.primary1Color},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},l.default.createElement(E,{label:o||this.props.getMessage("191"),horizontalPosition:"center",verticalPosition:"bottom",show:i}),l.default.createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:t.palette.primary1Color}}))),this.props.showMailer&&n.push(l.default.createElement(c.default,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),a&&n.push(l.default.createElement(c.default,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),p.default.qrcodeEnabled()&&n.push(l.default.createElement(c.default,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),this.props.onDisableLink&&n.push(l.default.createElement(c.default,{key:"delete",destructive:!0,callback:function(){return e.props.onDisableLink()},mdiIcon:"link-off",messageId:"45"})),n=n.length?l.default.createElement("div",{style:{display:"flex",margin:"20px 0 10px"}},l.default.createElement("span",{style:{flex:1}}),n,l.default.createElement("span",{style:{flex:1}})):null,a=this.state.showQRCode?l.default.createElement(s.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},l.default.createElement(u.default,{size:100,value:r,level:"Q"})):l.default.createElement(s.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),l.default.createElement(s.Paper,{zDepth:0,rounded:!1,className:"public-link-container"},l.default.createElement("div",{style:{marginTop:-8}},l.default.createElement(s.TextField,h({floatingLabelText:"Copy this link for public access",floatingLabelFixed:!0,type:"text",name:"Link",ref:"public-link-field",value:r,onFocus:function(e){e.target.select()},fullWidth:!0},k.textFieldV2))),!1,n,a)}}])&&m(e.prototype,t),n&&m(e,n),i}();w(C.default=e,"propTypes",{linkModel:t.default.instanceOf(i.default),editAllowed:t.default.bool,onChange:t.default.func,showMailer:t.default.func}),C.default=e=(0,o.muiThemeable)()(e),C.default=e=(0,n.default)(e),_.exports=C.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../main/ActionButton":26,"../main/ShareHelper":29,"./LinkModel":18,"./TargetedUsers":23,clipboard:"clipboard","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path","qrcode.react":"qrcode.react",react:"react"}],17:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var u=s(e("react")),o=s(e("prop-types")),i=s(e("pydio")),a=s(e("./LinkModel")),c=s(e("../main/ShareHelper")),f=s(e("./PublicLinkTemplate")),l=s(e("../ShareContextConsumer"));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=o?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=i.default.requireLib("hoc").ModernTextField,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,u["default"].Component);var e,t,n,o=y(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.apply(this,arguments)}return e=r,(t=[{key:"render",value:function(){function e(e){return o.MessageHash["share_center."+e]}var t,n=this.props,o=n.pydio,r=n.model,i=n.linkModel,a=n.style,l=n.showLayout,s=i.getLink(),n=c.default.compileLayoutData(o,r);return l&&1<n.length&&(t=u.default.createElement(f.default,{linkModel:i,pydio:o,layoutData:n,hideTitle:!0,readonly:r.getNode().isLeaf()})),u.default.createElement("div",{style:a},u.default.createElement(m,{variant:"v2",floatingLabelText:e(265),value:s.Label,onChange:function(e,t){s.Label=t,i.updateLink(s)},fullWidth:!0}),u.default.createElement(m,{variant:"v2",floatingLabelText:e(266),value:s.Description,onChange:function(e,t){s.Description=t,i.updateLink(s)},fullWidth:!0}),t)}}])&&d(e.prototype,t),n&&d(e,n),r}();n.default=e,n.default=e=(0,l.default)(e),e.PropTypes={pydio:o.default.instanceOf(i.default),linkModel:o.default.instanceOf(a.default)},t.exports=n.default},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"./PublicLinkTemplate":21,"prop-types":"prop-types",pydio:"pydio",react:"react"}],18:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=i(e("pydio")),l=i(e("pydio/http/api")),o=i(e("pydio/lang/observable")),s=i(e("../main/ShareHelper")),u=e("cells-sdk"),c=i(e("pydio/util/pass"));function i(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=o?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?y(t):e}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(i,o["default"]);var e,t,n,r=p(i);function i(){var e,t,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=r.call(this),t=y(e),o=void 0,(n="dirty")in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,e.link=new u.RestShareLink,e.link.Permissions=[u.RestShareLinkAccessType.constructFromObject("Preview"),u.RestShareLinkAccessType.constructFromObject("Download")],e.link.Policies=[],e.link.PoliciesContextEditable=!0,e.link.RootNodes=[],e.ValidPassword=!0,e.loadError=null,e}return e=i,(t=[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return s.default.buildPublicUrl(a.default.getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(t){return 0<this.link.Permissions.filter(function(e){return e===t}).length}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new u.ShareServiceApi(l.default.getRestClient()).getShareLink(e).then(function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")}).catch(function(e){t.loadError=e,t.notify("update")})}},{key:"setCreatePassword",value:function(e){var n=this;e?c.default.checkPasswordStrength(e,function(e,t){n.ValidPassword=e,n.ValidPasswordMessage=t}):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var n=this;e?c.default.checkPasswordStrength(e,function(e,t){n.ValidPassword=e,n.ValidPasswordMessage=t}):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var t=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var e=new u.ShareServiceApi(l.default.getRestClient()),n=new u.RestPutShareLinkRequest;this.createPassword?(n.PasswordEnabled=!0,n.CreatePassword=this.createPassword):this.updatePassword?(n.PasswordEnabled=!0,this.link.PasswordRequired?n.UpdatePassword=this.updatePassword:n.CreatePassword=this.updatePassword):n.PasswordEnabled=this.link.PasswordRequired;var o=s.default.getAuthorizations();if(o.password_mandatory&&!n.PasswordEnabled)throw new Error(a.default.getMessages()["share_center.175"]);return 0<parseInt(o.max_downloads)&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(o.max_downloads),this.notify("update")),0<parseInt(o.max_expiration)&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(o.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(n.UpdateCustomHash=this.customLink),n.ShareLink=this.link,e.putShareLink(n).then(function(e){t.link=e,t.dirty=!1,t.originalLink=t.clone(t.link),t.updatePassword=t.createPassword=t.customLink=null,t.ValidPassword=!0,t.notify("update"),t.notify("save")}).catch(function(e){e=e.Detail||e.message||e;a.default.getInstance().UI.displayMessage("ERROR",e)})}},{key:"deleteLink",value:function(t){var n=this;return new u.ShareServiceApi(l.default.getRestClient()).deleteShareLink(this.link.Uuid).then(function(e){n.link=t,n.dirty=!1,n.updatePassword=n.createPassword=n.customLink=null,n.notify("update"),n.notify("delete")}).catch(function(e){e=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",e)})}},{key:"clone",value:function(e){return u.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}])&&f(e.prototype,t),n&&f(e,n),i}();n.default=e,t.exports=n.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable","pydio/util/pass":"pydio/util/pass"}],19:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var h=u(e("react")),o=u(e("../ShareContextConsumer")),m=u(e("./Field")),b=u(e("./Permissions")),g=u(e("./TargetedUsers")),v=e("material-ui"),i=u(e("./LinkModel")),a=u(e("../composite/CompositeModel")),l=u(e("prop-types")),s=u(e("pydio")),O=u(e("../main/ShareHelper")),w=u(e("./SecureOptions"));function u(e){return e&&e.__esModule?e:{default:e}}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function c(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach(function(e){d(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function E(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=M(n);return e=o?(e=M(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?C(t):e}}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=s.default.requireLib("form").ValidPassword,R=s.default.requireLib("hoc").ModernStyles,L=function(){P(o,h["default"].Component);var n=_(o);function o(e){var t;return p(this,o),(t=n.call(this,e)).state={active:!!e.active},t}return E(o,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,o=t.children,r=this.state.active,t={title:{cursor:"pointer",fontSize:15,padding:16,paddingBottom:r?8:16,display:"flex",alignItems:"center"},content:{padding:"0 16px 8px"},chevron:{fontSize:24,color:"rgba(0,0,0,.3)"}};return h.default.createElement(h.default.Fragment,null,h.default.createElement("div",{style:f({},t.title),onClick:function(){e.setState({active:!r})}},h.default.createElement("span",{style:{flex:1}},n),h.default.createElement("span",{className:"mdi mdi-chevron-"+(r?"down":"right"),style:t.chevron})),r&&h.default.createElement("div",{style:f({},t.content)},o))}}]),o}(),e=function(){P(i,h["default"].Component);var r=_(i);function i(){var n;p(this,i);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return d(C(n=r.call.apply(r,[this].concat(t))),"state",{showTemporaryPassword:!1,temporaryPassword:null,saving:!1}),d(C(n),"toggleLink",function(){var e=n.props,t=e.linkModel;e.pydio;n.state.showTemporaryPassword?n.setState({showTemporaryPassword:!1,temporaryPassword:null}):!t.getLinkUuid()&&O.default.getAuthorizations().password_mandatory?n.setState({showTemporaryPassword:!0,temporaryPassword:""}):(n.setState({saving:!0}),(t.getLinkUuid()?n.props.compositeModel.deleteLink(t):t.save()).catch(function(){n.setState({saving:!1})}).then(function(){n.setState({saving:!1})}))}),d(C(n),"updateTemporaryPassword",function(e,t){void 0===e&&(e=t.currentTarget.getValue()),n.setState({temporaryPassword:e})}),d(C(n),"enableLinkWithPassword",function(){var e=n.props.linkModel;if(n.state.temporaryPasswordState){e.setCreatePassword(n.state.temporaryPassword);try{e.save()}catch(e){n.props.pydio.UI.displayMessage("ERROR",e.message)}n.setState({showTemporaryPassword:!1,temporaryPassword:null})}else n.props.pydio.UI.displayMessage("ERROR","Invalid Password")}),n}return E(i,[{key:"render",value:function(){var t,e,n=this,o=this.props,r=o.linkModel,i=o.pydio,a=o.compositeModel,l=o.toggleOnly,s=o.additionalPanes,u=this.state,c=u.showTemporaryPassword,f=u.temporaryPassword,d=u.saving,p=O.default.getAuthorizations(),o=a.getNode().isLeaf(),u=o&&p.file_public_link||!o&&p.folder_public_link,y={backgroundColor:"#eee"};return r.getLinkUuid()?(this.props.isReadonly()||d||!r.isEditable()||!r.getLinkUuid()&&!u||(e=function(){return n.toggleLink()}),e=h.default.createElement(m.default,{pydio:i,linkModel:r,showMailer:this.props.showMailer,editAllowed:p.editable_hash&&r.isEditable(),onDisableLink:e,key:"public-link"}),t=[h.default.createElement(v.Divider,{style:y}),h.default.createElement(L,{title:this.props.getMessage("70r")},h.default.createElement(b.default,{compositeModel:a,linkModel:r,pydio:i,key:"public-perm"}))],r.getLink().TargetUsers&&(t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(g.default,{linkModel:r,pydio:i}))),t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(L,{title:this.props.getMessage("24")},h.default.createElement(w.default,{pydio:i,linkModel:r}))),s&&s.forEach(function(e){t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(L,{title:e.title},e.content))})):e=c?h.default.createElement("div",null,h.default.createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),h.default.createElement("div",{style:{width:"100%"}},h.default.createElement(j,{attributes:{label:this.props.getMessage("23")},value:f,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return n.setState({temporaryPasswordState:e})}})),h.default.createElement("div",{style:{textAlign:"center",marginTop:20}},h.default.createElement(v.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):u?h.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage("190")):h.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage(o?"225":"226")),h.default.createElement("div",{style:this.props.style},!(r.getLinkUuid()||c)&&h.default.createElement("div",{style:{padding:16}},h.default.createElement(v.Toggle,k({disabled:this.props.isReadonly()||d||!r.isEditable()||!r.getLinkUuid()&&!u,onToggle:this.toggleLink,toggled:r.getLinkUuid()||c,label:this.props.getMessage("189")},R.toggleFieldV2))),d&&h.default.createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},h.default.createElement(v.CircularProgress,null)),!l&&!d&&h.default.createElement("div",{style:{padding:16}},e),!l&&!d&&t)}}]),i}();d(n.default=e,"propTypes",{linkModel:l.default.instanceOf(i.default),compositeModel:l.default.instanceOf(a.default),pydio:l.default.instanceOf(s.default),authorizations:l.default.object,showMailer:l.default.func}),n.default=e=(0,o.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"../composite/CompositeModel":11,"../main/ShareHelper":29,"./Field":16,"./LinkModel":18,"./Permissions":20,"./SecureOptions":22,"./TargetedUsers":23,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],20:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=f(e("react")),o=f(e("prop-types")),a=(f(e("pydio")),f(e("../ShareContextConsumer"))),l=e("material-ui"),s=f(e("./LinkModel")),u=f(e("../main/ShareHelper")),c=e("cells-sdk");function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(n);return e=o?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?h(t):e}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,i["default"].Component);var e,t,n,o=y(r);function r(){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(h(i=o.call.apply(o,[this].concat(t))),"changePermission",function(e){var t=e.target.name,n=e.target.checked,o=i.props,r=o.compositeModel,e=o.linkModel,o=e.getLink();n?o.Permissions.push(c.RestShareLinkAccessType.constructFromObject(t)):o.Permissions=o.Permissions.filter(function(e){return e!==t}),r.getNode().isLeaf()&&(r=u.default.getAuthorizations().max_downloads,e.hasPermission("Preview")?(o.ViewTemplateName="pydio_unique_strip",o.MaxDownloads=0):(o.ViewTemplateName="pydio_unique_dl",r&&!o.MaxDownloads&&(o.MaxDownloads=r))),i.props.linkModel.updateLink(o)}),i}return e=r,(t=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.compositeModel,o=e.pydio,r=n.getNode(),e=[],n=u.default.getAuthorizations();return r.isLeaf()?(r=(o=u.default.nodeHasEditor(o,r)).preview,o=o.writeable,e.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!r||!t.hasPermission("Preview")}),r&&!n.max_downloads&&(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Download")}),t.hasPermission("Preview")&&o&&e.push({NAME:"Upload",LABEL:this.props.getMessage("74b")}))):(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Upload")}),e.push({NAME:"Download",LABEL:this.props.getMessage("73")}),e.push({NAME:"Upload",LABEL:this.props.getMessage("74")})),i.default.createElement("div",null,e.map(function(e){return i.default.createElement(l.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!t.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:t.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0)}}])&&d(e.prototype,t),n&&d(e,n),r}();b(n.default=e,"propTypes",{linkModel:o.default.instanceOf(s.default),style:o.default.object}),n.default=e=(0,a.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"cells-sdk":"cells-sdk","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(e("react")),o=u(e("prop-types")),a=u(e("pydio")),l=u(e("../ShareContextConsumer")),s=e("material-ui"),e=u(e("./LinkModel"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n);return e=o?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=a.default.requireLib("hoc").ModernSelectField,a=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,i["default"].Component);var e,t,n,o=d(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.apply(this,arguments)}return e=r,(t=[{key:"onDropDownChange",value:function(e,t,n){var o=this.props.linkModel;o.getLink().ViewTemplateName=n,o.notifyDirty()}},{key:"render",value:function(){var t,e=this.props,n=e.linkModel,o=e.hideTitle,r=n.getLink().ViewTemplateName,e=this.props.layoutData.map(function(e){return r&&e.LAYOUT_ELEMENT===r&&(t=e.LAYOUT_LABEL),r||t||(r=e.LAYOUT_ELEMENT,t=e.LAYOUT_LABEL),i.default.createElement(s.MenuItem,{key:e.LAYOUT_ELEMENT,value:e.LAYOUT_ELEMENT,primaryText:e.LAYOUT_LABEL})});return i.default.createElement("div",{style:this.props.style},!o&&i.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("151")),i.default.createElement(y,{variant:"v2",fullWidth:!0,value:r,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!n.isEditable(),floatingLabelText:this.props.getMessage("151")},e))}}])&&c(e.prototype,t),n&&c(e,n),r}();a.PropTypes={linkModel:o.default.instanceOf(e.default)};a=(0,l.default)(a);n.default=a,t.exports=n.default},{"../ShareContextConsumer":1,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],22:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var y=u(e("react")),o=u(e("prop-types")),l=u(e("pydio")),i=u(e("pydio/util/pass")),h=e("material-ui"),a=u(e("../ShareContextConsumer")),s=u(e("./LinkModel")),m=u(e("../main/ShareHelper"));function u(e){return e&&e.__esModule?e:{default:e}}function c(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach(function(e){w(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(n);return e=o?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?v(t):e}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=l.default.requireLib("form").ValidPassword,e=l.default.requireLib("hoc"),E=e.ModernTextField,P=e.ModernStyles,S={iconButton:{style:{width:40,height:40,padding:6},iconStyle:{color:"rgba(0,0,0,.5)",fontSize:20}},leftIcon:{margin:"0 16px 0 4px",color:"#757575"}},e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,y["default"].Component);var e,t,n,o=p(r);function r(){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(v(a=o.call.apply(o,[this].concat(t))),"state",{}),w(v(a),"updateDLExpirationField",function(e){var t=e.currentTarget.value;parseInt(t)<0&&(t=-parseInt(t));var n=a.props.linkModel,e=n.getLink();e.MaxDownloads=t,n.updateLink(e)}),w(v(a),"updateDaysExpirationField",function(e,t){t=t||e.currentTarget.getValue();var n=a.props.linkModel,e=n.getLink();e.AccessEnd=t,n.updateLink(e)}),w(v(a),"onDateChange",function(e,t){t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());a.updateDaysExpirationField(e,Math.floor(t/1e3)+"")}),w(v(a),"resetPassword",function(){var e=a.props.linkModel;e.setUpdatePassword(""),e.getLink().PasswordRequired=!1,e.notifyDirty()}),w(v(a),"setUpdatingPassword",function(n){i.default.checkPasswordStrength(n,function(e,t){a.setState({updatingPassword:n,updatingPasswordValid:e})})}),w(v(a),"changePassword",function(){var e=a.props.linkModel,t=a.state.updatingPassword;e.setUpdatePassword(t),a.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),e.notifyDirty()}),w(v(a),"updatePassword",function(e,t){var n=a.props.linkModel;a.state.validPasswordStatus?a.setState({invalidPassword:null,invalid:!1},function(){n.setUpdatePassword(e)}):a.setState({invalidPassword:e,invalid:!0})}),w(v(a),"resetDownloads",function(){var e;window.confirm(a.props.getMessage("106"))&&((e=a.props.linkModel).getLink().CurrentDownloads="0",e.notifyDirty())}),w(v(a),"resetExpiration",function(){var e=a.props.linkModel;e.getLink().AccessEnd="0",e.notifyDirty()}),w(v(a),"renderPasswordContainer",function(){var e,t,n,o=a.props.linkModel,r=o.getLink(),i=m.default.getAuthorizations();return r.PasswordRequired?(t=y.default.createElement(h.IconButton,g({iconClassName:"mdi mdi-close-circle",disabled:a.props.isReadonly()||!o.isEditable()||i.password_mandatory,secondary:!0,onClick:a.resetPassword,tooltip:a.props.getMessage("174")},S.iconButton)),n=y.default.createElement("div",null,y.default.createElement(h.IconButton,g({iconClassName:"mdi mdi-pencil",disabled:a.props.isReadonly()||!o.isEditable(),secondary:!0,onClick:function(e){a.setState({pwPop:!0,pwAnchor:e.currentTarget})},tooltip:a.props.getMessage("181")},S.iconButton)),y.default.createElement(h.Popover,{open:a.state.pwPop,anchorEl:a.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){a.setState({pwPop:!1})}},y.default.createElement("div",{style:{width:380,padding:8}},y.default.createElement(k,{name:"update",ref:"pwdUpdate",attributes:{label:a.props.getMessage("23")},value:a.state.updatingPassword||"",onChange:function(e){a.setUpdatingPassword(e)},onValidStatusChange:function(e){return a.setState({updatingPasswordDiffer:!e})},variant:"v2"}),y.default.createElement("div",{style:{paddingTop:20,textAlign:"right"}},y.default.createElement(h.FlatButton,{label:l.default.getMessages()[54],onClick:function(){a.setState({pwPop:!1,updatingPassword:""})}}),y.default.createElement(h.FlatButton,{style:{minWidth:60},label:l.default.getMessages()[48],onClick:function(){a.changePassword()},disabled:!a.state.updatingPassword||!a.state.updatingPasswordValid||a.state.updatingPasswordDiffer}))))),e=y.default.createElement(E,{floatingLabelText:a.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0,variant:"v2"})):!a.props.isReadonly()&&o.isEditable()&&(e=y.default.createElement(k,{name:"share-password",ref:"pwd",attributes:{label:a.props.getMessage("23")},value:a.state.invalidPassword||o.updatePassword,onChange:a.updatePassword.bind(v(a)),onValidStatusChange:function(e){a.setState({validPasswordStatus:e})},variant:"v2"})),e?y.default.createElement("div",{className:"password-container",style:{display:"flex",alignItems:"baseline",width:"100%",position:"relative"}},y.default.createElement("div",{style:{width:"100%",display:"inline-block"}},e),t&&y.default.createElement("div",{style:{position:"absolute",right:0,bottom:0,display:"flex"}},n,t)):null}),w(v(a),"formatDate",function(e){return a.props.getMessage("date_format","").split(" ").shift().replace("Y",e.getFullYear()).replace("m",e.getMonth()+1).replace("d",e.getDate())}),a}return e=r,(t=[{key:"render",value:function(){var e,t,n,o,r=this.props.linkModel,i=r.getLink(),a=this.renderPasswordContainer(),l=r.hasPermission("Download")&&!r.hasPermission("Preview")&&!r.hasPermission("Upload"),s=parseInt(i.MaxDownloads),u=parseInt(i.AccessEnd),c=!1,f=!1,d=new Date,p=m.default.getAuthorizations();return 0<parseInt(p.max_expiration)&&(n=new Date).setDate(d.getDate()+parseInt(p.max_expiration)),0<parseInt(p.max_downloads)&&(s=Math.max(1,Math.min(s,parseInt(p.max_downloads)))),u&&(u<0&&(c=!0),t=new Date(1e3*u),parseInt(p.max_expiration)||(e=y.default.createElement(h.IconButton,{iconStyle:S.iconButton.iconStyle,style:b(b({},S.iconButton.style),{},{position:"absolute",right:0,bottom:0,zIndex:1}),iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),s&&((i=parseInt(i.CurrentDownloads)||0)&&(o=y.default.createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),s<=i&&(f=!0)),o=y.default.createElement("span",{className:"dlCounterString"},i+"/"+s," ",o)),y.default.createElement("div",null,a,y.default.createElement("div",{style:{display:"flex",alignItems:"baseline",position:"relative"},className:c?"limit-block-expired":null},y.default.createElement(h.DatePicker,g({ref:"expirationDate",key:"start",value:t,minDate:new Date,maxDate:n,autoOk:!0,disabled:this.props.isReadonly()||!r.isEditable(),onChange:this.onDateChange,showYearSelector:!0,floatingLabelText:this.props.getMessage(c?"21b":"21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},P.textFieldV2,{style:{flex:1},textFieldStyle:b(b({},P.textFieldV2.style),{},{flex:1})})),e),y.default.createElement("div",{style:{alignItems:"baseline",display:l?"flex":"none",position:"relative"},className:f?"limit-block-expired":null},y.default.createElement(E,{type:"number",disabled:this.props.isReadonly()||!r.isEditable(),floatingLabelText:this.props.getMessage(f?"22b":"22"),value:0<s?s:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1},variant:"v2"}),y.default.createElement("span",{style:{position:"absolute",right:10,top:14,fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},o)))}}])&&f(e.prototype,t),n&&f(e,n),r}();w(n.default=e,"propTypes",{linkModel:o.default.instanceOf(s.default).isRequired,style:o.default.object}),n.default=e=(0,a.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],23:[function(w,k,E){!function(O){!function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=s(w("prop-types")),i=s(w("react")),o=s(w("react-dom")),t=s(w("../ShareContextConsumer")),a=w("material-ui"),l=s(w("clipboard")),n=s(w("../links/LinkModel"));function s(e){return e&&e.__esModule?e:{default:e}}function u(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function c(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(n);return e=o?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(){y(n,i["default"].Component);var t=m(n);function n(e){return f(this,n),(e=t.call(this,e)).state={copyMessage:""},e}return p(n,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new l.default(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e=0===O.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143");this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var t=this,e=this.props,n=e.targetUser,e=e.link;return i.default.createElement("div",{style:{display:"flex"}},i.default.createElement("div",{style:{flex:1}},n.Display,i.default.createElement(a.IconButton,{pydio:this.props.pydio,ref:function(e){t._button=o.default.findDOMNode(e)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||e,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),i.default.createElement("div",{style:{width:40,textAlign:"center"}},n.DownloadCount))}}]),n}(),v=function(){y(o,i["default"].Component);var n=m(o);function o(e,t){return f(this,o),(t=n.call(this,e,t)).state={open:!1},t}return p(o,[{key:"render",value:function(){var n,e=this,o=this.props.linkModel,t=o.getLink();t.TargetUsers&&(n=t.TargetUsers);var r=Object.keys(n).map(function(e){var t=o.getPublicUrl()+"?u="+e;return i.default.createElement(g,{targetUser:n[e],link:t})});if(!r.length)return null;t={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"};return i.default.createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},i.default.createElement("div",{style:c({display:"flex"},t)},i.default.createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",r.length)," ",i.default.createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){e.setState({open:!e.state.open})}})),this.state.open&&i.default.createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&i.default.createElement("div",null,r))}}]),o}();(E.default=v).propTypes={linkModel:e.default.instanceOf(n.default)},E.default=v=(0,t.default)(v),g=(0,t.default)(g),k.exports=E.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../links/LinkModel":18,clipboard:"clipboard","material-ui":"material-ui","prop-types":"prop-types",react:"react","react-dom":"react-dom"}],24:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=f(e("react")),o=f(e("../ShareContextConsumer")),i=f(e("prop-types")),l=f(e("pydio")),s=f(e("pydio/http/policies")),u=e("cells-sdk"),c=f(e("./LinkModel"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(n);return e=o?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?b(t):e}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=l.default.requireLib("components").ResourcePoliciesPanel,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,a["default"].Component);var e,t,n,o=m(i);function i(){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v(b(r=o.call.apply(o,[this].concat(t))),"onSavePolicies",function(n){var e=r.props,t=e.linkModel,o=(e.pydio,t.getLink().UserLogin);s.default.loadPolicies("user",o).then(function(e){var t;e.length&&(t=e[0].Resource,t=r.diffPolicies(e,n,t),s.default.savePolicies("user",o,t))})}),v(b(r),"diffPolicies",function(e,n,o){var r=[];return e.map(function(e){var t=e.Action+"///"+e.Subject;n.remove[t]||r.push(e)}),Object.keys(n.add).map(function(e){var t=new u.ServiceResourcePolicy,n=d(e.split("///"),2),e=n[0],n=n[1];t.Resource=o,t.Effect=u.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),t.Subject=n,t.Action=e,r.push(t)}),r}),r}return e=i,(t=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.pydio,o=[];o["user:"+t.getLink().UserLogin]=!0;e={READ:o,WRITE:o};return a.default.createElement("div",{style:this.props.style},t.getLink().Uuid&&a.default.createElement(O,{pydio:n,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:t.getLink().Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:e,subjectsHidden:o,readonly:this.props.isReadonly()||!t.isEditable(),ref:"policies"}))}}])&&y(e.prototype,t),n&&y(e,n),i}();e.PropTypes={pydio:i.default.instanceOf(l.default).isRequired,linkModel:i.default.instanceOf(c.default).isRequired};e=(0,o.default)(e);n.default=e,t.exports=n.default},{"../ShareContextConsumer":1,"./LinkModel":18,"cells-sdk":"cells-sdk","prop-types":"prop-types",pydio:"pydio","pydio/http/policies":"pydio/http/policies",react:"react"}],25:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.ShareViewModal=n.ShareView=void 0;var s=p(e("react")),o=p(e("create-react-class")),i=p(e("prop-types")),a=p(e("pydio")),l=p(e("pydio/http/api")),u=p(e("pydio/model/node")),c=p(e("pydio/util/path")),f=e("cells-sdk"),d=e("material-ui");function p(e){return e&&e.__esModule?e:{default:e}}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function h(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function m(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=E(n);return e=o?(e=E(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=a.default.requireLib("boot"),S=P.ActionDialogMixin,_=P.Loader,P=a.default.requireLib("components"),C=P.ModalAppBar,M=P.EmptyStateView,j=a.default.requireLib("hoc").ModernTextField,e=e("material-ui/styles").muiThemeable,R=function(){O(t,s["default"].Component);var e=k(t);function t(){return b(this,t),e.apply(this,arguments)}return v(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.onChange,o=e.muiTheme,r=e.m,i={color:"#616161"},e={color:o.palette.accent1Color},o={marginRight:5};return s.default.createElement(d.Tabs,{style:{width:360},onChange:function(e){n(null,0,e)},value:t,tabItemContainerStyle:{background:"transparent"}},s.default.createElement(d.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:o,className:"mdi mdi-share-variant"}),r(243)),value:"LINKS",buttonStyle:"LINKS"===t?e:i}),s.default.createElement(d.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:o,className:"icomoon-cells"}),r(254)),value:"CELLS",buttonStyle:"CELLS"===t?e:i}))}}]),t}(),R=e()(R),L=function(){O(o,s["default"].Component);var n=k(o);function o(e){var t;return b(this,o),(t=n.call(this,e)).state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"},t}return v(o,[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var t=this;this.setState({filter:""});var e=new f.ShareServiceApi(l.default.getRestClient()),n=new f.RestListSharedResourcesRequest;n.ShareType=f.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?n.Subject=this.props.subject:n.OwnedBySubject=!0,this.setState({loading:!0}),e.listSharedResources(n).then(function(e){t.setState({resources:e.Resources||[],loading:!1})}).catch(function(){t.setState({loading:!1})})}},{key:"getLongestPath",value:function(e){if(!e.AppearsIn)return{path:e.Path,basename:e.Path};var t={};e.AppearsIn.map(function(e){t[e.Path]=e});var n=Object.keys(t);n.sort();e=n[n.length-1],n=(n=c.default.getBasename(e))||t[e].WsLabel;return{path:e,appearsIn:t[e],basename:n}}},{key:"goTo",value:function(e){var t=e.Path,n=e.WsLabel,e=e.WsUuid,t=t.split("/");t.shift();t=new u.default(t.join("/"));t.getMetadata().set("repository_id",e),t.getMetadata().set("repository_label",n),this.props.pydio.goTo(t),this.props.onRequestClose()}},{key:"render",value:function(){function r(e){return a.MessageHash["share_center."+e]}var i=this,e=this.state,t=e.loading,n=e.resources,e=e.filter,o=void 0===e?"":e,e=this.props,a=e.pydio,e=e.style;n.sort(function(e,t){e=e.Node.Path,t=t.Node.Path;return e===t?0:t<e?1:-1});var l=a.Registry.getFilesExtensions();return s.default.createElement("div",{style:m(m({},e),{},{display:"flex",flexDirection:"column",overflow:"hidden"})},s.default.createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},s.default.createElement(R,{m:r,value:this.state.shareType,onChange:function(e,t,n){i.setState({shareType:n},function(){i.load()})}}),s.default.createElement("span",{style:{flex:1}}),s.default.createElement("div",{style:{width:150}},s.default.createElement(j,{hintText:r("sharelist.quick-filter"),value:o,onChange:function(e,t){i.setState({filter:t})},fullWidth:!0}))),t&&s.default.createElement(_,{style:{height:400}}),!t&&0===n.length&&s.default.createElement(M,{pydio:a,iconClassName:"mdi mdi-share-variant",primaryTextId:r(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!t&&0<n.length&&s.default.createElement(d.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},n.map(function(e){var t,n=i.getLongestPath(e.Node),o=n.appearsIn,n=n.basename;return t=-1===n.indexOf(".")?"mdi mdi-folder":(t=c.default.getFileExtension(n),l.has(t)?"mdi mdi-"+l.get(t).fontIcon:"mdi mdi-file"),{primaryText:n=e.Link&&e.Link.Label&&e.Link.Label!==n?e.Link.Label+" ("+n+")":n,secondaryText:e.Link?r(251)+": "+e.Link.Description:r(284).replace("%s",e.Cells.length),icon:t,appearsIn:o}}).filter(function(e){return!o||-1!==e.primaryText.toLowerCase().indexOf(o.toLowerCase())}).map(function(e){var t=e.appearsIn,n=e.icon;return s.default.createElement(d.ListItem,{primaryText:e.primaryText,secondaryText:e.secondaryText,onClick:function(){t&&i.goTo(t)},disabled:!t,leftIcon:s.default.createElement(d.FontIcon,{className:n})})})))}}]),o}();(n.ShareView=L).childContextTypes={messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func};S=(0,o.default)({displayName:"ShareViewModal",mixins:[S],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return s.default.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},s.default.createElement(C,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),s.default.createElement(L,y({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}});n.ShareViewModal=S},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/path":"pydio/util/path",react:"react"}],26:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=(o=e("../ShareContextConsumer"))&&o.__esModule?o:{default:o};function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(n);return e=o?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("prop-types"),f=e("react").Component,d=e("material-ui").IconButton,p=e("material-ui/styles").muiThemeable,y=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(r,f);var e,t,n,o=s(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.apply(this,arguments)}return e=r,(t=[{key:"render",value:function(){var e=this.props.muiTheme.palette,t=this.props.destructive?"#d32f2f":e.primary1Color,n={root:{borderRadius:"50%",border:"1px solid "+t,backgroundColor:"transparent",width:36,height:36,padding:"8px 6px",margin:"0 6px",zIndex:0},icon:{color:t,fontSize:20,lineHeight:"20px"}},o=this.props,r=o.tooltip,e=o.messageId,t=o.getMessage,o=o.messageCoreNamespace;return e&&t&&(r=this.props.getMessage(e,o||void 0)),React.createElement(d,{style:n.root,iconStyle:n.icon,onClick:this.props.callback||this.props.onClick,iconClassName:this.props.mdiIcon?"mdi mdi-"+this.props.mdiIcon:this.props.iconClassName,tooltip:r,tooltipPosition:this.props.tooltipPosition})}}])&&a(e.prototype,t),n&&a(e,n),r}();y.propTypes={callback:c.func,onClick:c.func,mdiIcon:c.string,messageId:c.string},y=(0,i.default)(y);y=p()(y);n.default=y,t.exports=n.default},{"../ShareContextConsumer":1,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],27:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,p=(o=e("react"))&&o.__esModule?o:{default:o},y=e("material-ui"),i=e("material-ui/styles");function h(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function l(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function m(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(n);return e=o?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){f(t,p["default"].Component);var e=b(t);function t(){return s(this,t),e.apply(this,arguments)}return c(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,o=e.active,r=e.onChange,n=e.style,i=e.muiTheme.palette.primary1Color;return p.default.createElement("div",{style:m({display:"flex"},n)},t.map(function(e){var t=e.Value===o,n=e.Label;return e.Icon&&(n=p.default.createElement("span",null,p.default.createElement("span",{className:e.Icon,style:{marginLeft:-5}})," ",e.Label)),p.default.createElement(y.FlatButton,{label:n,onClick:function(){r(e.Value)},primary:t,style:{flex:1,height:46,lineHeight:"46px",borderBottom:t?"3px solid "+i:0},labelStyle:{textTransform:"none",fontSize:15,color:t?i:"rgba(0,0,0,.3)"}})}))}}]),t}(),v=(0,i.muiThemeable)()(v),O=function(){f(t,p["default"].Component);var e=b(t);function t(){return s(this,t),e.apply(this,arguments)}return c(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,o=null;return t.map(function(e){e.Value===n&&(o=e.Component)}),o}}]),t}(),i=function(){f(o,p["default"].Component);var n=b(o);function o(e){var t;return s(this,o),(t=n.call(this,e)).state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""},t}return c(o,[{key:"componentWillReceiveProps",value:function(e){!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var t=this,e=this.props,n=e.tabs,o=e.header,r=e.onSaveAction,i=e.onCloseAction,a=e.onRevertAction,l=e.saveEnabled,s=e.style,u=e.pydio,c=e.editorOneColumn,f=this.state,d=f.left,e=f.right;if(c){f=[].concat(h(n.left),h(n.right)),c=f.filter(function(e){return e.AlwaysLast});return(f=c.length?[].concat(h(f.filter(function(e){return!e.AlwaysLast})),h(c)):f).length&&0===f.filter(function(e){return e.Value===d}).length&&(d=f[0].Value),p.default.createElement("div",{style:m({display:"flex",flexDirection:"column",height:"100%"},s)},p.default.createElement("div",{style:{display:"flex",alignItems:"center"}},p.default.createElement("div",{style:{flex:1,padding:10}},o),p.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:i,style:{marginRight:10}})),p.default.createElement("div",{style:{display:"flex"}},p.default.createElement(v,{tabs:f,active:d,style:{flex:1,padding:"0 16px"},onChange:function(e){t.setState({left:e})}})),p.default.createElement(y.Divider,{style:{flexShrink:0,backgroundColor:"#e0e0e0"}}),p.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden"}},p.default.createElement("div",{style:m({overflowY:"auto",width:"100%",height:"100%"},n.leftStyle)},p.default.createElement(O,{tabs:f,active:d}))),p.default.createElement("div",{style:{borderTop:"1px solid #eeeeee",padding:10,display:"flex",alignItems:"center",justifyContent:"flex-end"}},p.default.createElement(y.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:a,style:{marginLeft:10}}),p.default.createElement(y.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:r})))}return n.left&&n.left.length&&0===n.left.filter(function(e){return e.Value===d}).length&&(d=n.left[0].Value),n.right&&n.right.length&&0===n.right.filter(function(e){return e.Value===d}).length&&(e=n.right[0].Value),p.default.createElement("div",{style:m({backgroundColor:"#fafafa",display:"flex",flexDirection:"column",height:"100%"},s)},p.default.createElement("div",{style:{display:"flex",alignItems:"center",padding:10,paddingBottom:0}},p.default.createElement("div",{style:{flex:1,alignItems:"center",paddingRight:20}},o),p.default.createElement(y.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:r}),p.default.createElement(y.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:a,style:{marginLeft:10}}),p.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:i,style:{marginLeft:10}})),p.default.createElement("div",{style:{display:"flex"}},p.default.createElement(v,{tabs:n.left,active:d,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({left:e})}}),p.default.createElement(v,{tabs:n.right,active:e,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({right:e})}})),p.default.createElement(y.Divider,{style:{flexShrink:0,display:"none"}}),p.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",padding:"0 5px 5px"}},p.default.createElement(y.Paper,{zDepth:1,style:m({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.leftStyle)},p.default.createElement(O,{tabs:n.left,active:d})),p.default.createElement(y.Paper,{zDepth:1,style:m({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.rightStyle)},p.default.createElement(O,{tabs:n.right,active:e}))))}}]),o}();n.default=i,t.exports=n.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],28:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("react")),a=o(e("../composite/CompositeCard")),l=o(e("../cells/CellCard"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(n);return e=o?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,i["default"].Component);var e,t,n,o=c(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,e)).state={popoverOpen:!1},e}return e=r,(t=[{key:"openPopover",value:function(e){this.setState({popoverOpen:!0,popoverAnchor:e.target})}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.node,o=e.popoverPanel,e=e.popoverRequestClose;return n.isRoot()?i.default.createElement(PydioWorkspaces.InfoPanelCard,{popoverPanel:o},i.default.createElement("div",{style:{padding:0}},i.default.createElement(l.default,{cellId:t.user.activeRepository,pydio:t,mode:"infoPanel"}))):i.default.createElement(PydioWorkspaces.InfoPanelCard,{popoverPanel:o},i.default.createElement("div",{style:{padding:0}},i.default.createElement(a.default,{node:n,pydio:t,mode:"infoPanel",popoverPanel:o,popoverRequestClose:e})))}}])&&s(e.prototype,t),n&&s(e,n),r}();n.default=e,t.exports=n.default},{"../cells/CellCard":2,"../composite/CompositeCard":9,react:"react"}],29:[function(n,l,u){!function(i){!function(){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var o=e(n("pydio/util/xml")),s=e(n("pydio/http/api")),c=e(n("pydio")),f=n("cells-sdk");function e(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=c.default.requireLib("boot").moment,t=function(){function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u)}var e,t,n;return e=u,n=[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=c.default.getInstance(),t=e.getPluginConfigs("action.share"),n={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD")},t=t.get("SHARE_FORCE_PASSWORD");return t&&(n.password_mandatory=!0),n.password_placeholder=t?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],n}},{key:"buildPublicUrl",value:function(e,t){var n=e.Parameters;if(2<arguments.length&&void 0!==arguments[2]&&arguments[2])return"..."+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash;if(t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://")))return t.LinkUrl;e=e.getFrontendUrl();return"".concat(e.protocol,"//").concat(e.host)+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash}},{key:"nodeHasEditor",value:function(e,t){var n;return t.getMetadata().has("mime_has_preview_editor")||(e=(n=(n=e.Registry.findEditorsForMime(t.getAjxpMime())).filter(function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id})).filter(function(e){return e.canWrite}),t.getMetadata().set("mime_has_preview_editor",0<n.length),t.getMetadata().set("mime_has_writeable_editor",0<e.length)),{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(r,e){var i,a=e.getNode(),e=a.isLeaf()?(i=a.getAjxpMime(),o.default.XPathSelectNodes(r.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):o.default.XPathSelectNodes(r.getXmlRegistry(),"//template[contains(@name, 'minisite_')]");if(!e.length)return[];if(1===e.length)return[{LAYOUT_NAME:e[0].getAttribute("element"),LAYOUT_LABEL:""}];var l=r.Parameters.get("theme"),s=[];return e.map(function(e){var t,n,o=e.getAttribute("theme");o&&o!==l||(t=e.getAttribute("element"),n=e.getAttribute("name"),o=e.getAttribute("label"),i&&"unique_preview_file"===n&&!u.nodeHasEditor(r,a).preview||(o?MessageHash[o]&&(o=MessageHash[o]):o=e.getAttribute("name"),s[n]=t,s.push({LAYOUT_NAME:n,LAYOUT_ELEMENT:t,LAYOUT_LABEL:o})))}),s}},{key:"forceMailerOldSchool",value:function(){return i.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return i.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},r=u.prepareEmail(e,null,t),i=r.templateId,e=r.templateData,a=new f.MailerMail,t=new f.MailerServiceApi(s.default.getRestClient());a.To=[];var l=0;Object.keys(n).map(function(e){var t=n[e],e=new f.MailerUser;return t.IdmUser&&t.IdmUser.Login&&t.IdmUser.Attributes&&(t.IdmUser.Attributes.hasEmail||t.IdmUser.Attributes.email)?(e.Uuid=t.IdmUser.Login,a.To.push(e)):l++,e});r=c.default.getInstance().MessageHash;a.To.length?(a.TemplateId=i,a.TemplateData=e,t.send(a).then(function(){o()}),t=r["core.mailer.1"].replace("%s",a.To.length),0<l&&(t+=" "+r["core.mailer.entries.ignored"]),c.default.getInstance().UI.displayMessage("SUCCESS",t)):c.default.getInstance().UI.displayMessage("ERROR",r["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o={},r="",i=pydio.user;return i.getPreference("displayName")?o.Inviter=i.getPreference("displayName"):o.Inviter=i.id,t?(i=t.getLink(),e.isLeaf()?(r="PublicFile",o.FileName=i.Label||e.getLabel()):(r="PublicFolder",o.FolderName=i.Label||e.getLabel()),o.LinkPath="/public/"+i.LinkHash,i.MaxDownloads&&(o.MaxDownloads=i.MaxDownloads+""),i.AccessEnd&&(i=a(new Date(1e3*i.AccessEnd)),o.Expire=i.format("LL"))):(r="Cell",o.Cell=n.getLabel()),{templateId:r,templateData:o,message:"",linkModel:t}}}],(t=null)&&r(e.prototype,t),n&&r(e,n),u}();u.default=t,l.exports=u.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/xml":"pydio/util/xml"}]},{},[15])(15)});