!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PydioActivityStreams=e()}(function(){return function r(o,a,i){function l(t,e){if(!a[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,r,o,a,i)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<i.length;e++)l(i[e]);return l}({1:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=c(e("pydio")),s=c(e("react")),o=c(e("prop-types")),f=c(e("react-markdown")),p=e("material-ui"),a=e("material-ui/styles"),d=c(e("pydio/util/path")),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((a=o?Object.getOwnPropertyDescriptor(e,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("./DocLink"));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function m(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(n);return e=r?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=r.default.requireLib("components").UserAvatar,e=r.default.requireLib("boot").PydioContextConsumer,S=r.default.requireLib("workspaces").FilePreview,x=r.default.requireLib("boot").moment,E=function(){O(t,s["default"].Component);var e=_(t);function t(){return b(this,t),e.apply(this,arguments)}return g(t,[{key:"render",value:function(){return s.default.createElement("span",null,this.props.children)}}]),t}();r=function(){O(t,s["default"].Component);var e=_(t);function t(){return b(this,t),e.apply(this,arguments)}return g(t,[{key:"computeIcon",value:function(e){var t,n="";switch(e.type){case"Create":n="Document"===e.object.type?"file-plus":"folder-plus",t="Created";break;case"Delete":n="delete",t="Deleted";break;case"Edit":case"Update":n="pencil",t="Modified";break;case"UpdateMeta":n="tag-multiple",t="Modified";break;case"UpdateComment":n="message-outline",t="Commented";break;case"Read":n="eye",t="Accessed";break;case"Move":n="file-send",t="Moved";break;case"Share":n="share-variant","Cell"===e.object.type?n="icomoon-cells":"Workspace"===e.object.type&&(n="folder"),t="Shared"}return{title:t,className:n=-1===n.indexOf("icomoon-")?"mdi mdi-"+n:n}}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.activity,r=e.listContext,o=e.displayContext,a=e.oneLiner,i=e.muiTheme,l=n.type+(n.actor?" - "+n.actor.name:"");n.summary&&(u={paragraph:E,link:function(i,l,e){var c=2<arguments.length&&void 0!==e?e:void 0;return function(){O(t,s["default"].Component);var e=_(t);function t(){return b(this,t),e.apply(this,arguments)}return g(t,[{key:"render",value:function(){var e,t=this.props,n=t.href,r=t.children,o=m({cursor:"pointer",color:"rgb(66, 140, 179)",fontWeight:500},c),a=null;if(n.startsWith("doc://"))return"Delete"===l.type?s.default.createElement("a",{style:{textDecoration:"line-through"}},r):s.default.createElement(y.default,{pydio:i,activity:l,linkStyle:o},r);if(n.startsWith("user://")){t=n.replace("user://","");return s.default.createElement(j,{userId:t,displayAvatar:!1,richOnClick:!0,style:m(m({},o),{},{display:"inline-block"}),pydio:i})}return n.startsWith("workspaces://")&&(e=n.replace("workspaces://",""),i.user&&i.user.getRepositoriesList().get(e)&&(a=function(){i.triggerRepositoryChange(e)})),s.default.createElement("a",{title:"",style:o,onClick:a},r)}}]),t}()}(t,n,{color:"inherit"})},"NODE-LEAF"===r&&(u.link=function(){return null}),l=s.default.createElement(f.default,{source:n.summary,renderers:u}));var c,e={margin:"0px 10px 6px"},r="popover"===o?{fontSize:13,color:"rgba(0,0,0,0.53)",margin:"6px 0",padding:6}:{padding:"6px 22px 13px",marginTop:6,borderRadius:2,borderLeft:"2px solid #e0e0e0",marginLeft:14,color:"rgba(0,0,0,0.83)",overflow:"hidden"},u=this.computeIcon(n).className,l="popover"===o?(e={margin:0},i=(o=(0,y.nodesFromObject)(n.object,t)).length?(c=s.default.createElement("div",{style:{padding:"12px 20px 12px 20px",position:"relative"}},s.default.createElement(S,h({pydio:t,node:o[0],loadThumbnail:!0},{style:{height:36,width:36,borderRadius:"50%"},mimeFontStyle:{fontSize:20,lineHeight:"36px",textAlign:"center"}})),s.default.createElement("span",{className:u,style:{position:"absolute",bottom:8,right:12,fontSize:18,color:i.palette.accent2Color}})),o[0].getLabel()||d.default.getBasename(o[0].getPath())):(c=s.default.createElement("div",{style:{margin:"12px 20px 12px 20px",backgroundColor:"rgb(237, 240, 242)",alignItems:"initial",height:36,width:36,borderRadius:"50%",textAlign:"center"}},s.default.createElement(p.FontIcon,{className:u,style:{lineHeight:"36px",color:i.palette.accent2Color}})),(n.object||n).name),s.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",overflow:"hidden",paddingBottom:8}},c,s.default.createElement("div",{style:{flex:1,overflow:"hidden",paddingRight:16}},s.default.createElement("div",{style:{marginTop:12,marginBottom:2,fontSize:15,color:"rgba(0,0,0,.87)",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},i),s.default.createElement("div",{style:{color:"rgba(0,0,0,.33)"}},l)))):s.default.createElement("div",{style:r},l);return s.default.createElement("div",{style:e},!a&&s.default.createElement("div",{style:{display:"flex",alignItems:"center"}},n.actor&&s.default.createElement(j,{useDefaultAvatar:!0,userId:n.actor.id,userLabel:n.actor.name,displayLocalLabel:!0,userType:"user",pydio:t,style:{display:"flex",alignItems:"center",maxWidth:"60%"},labelStyle:{fontSize:14,fontWeight:500,paddingLeft:10,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},avatarStyle:{flexShrink:0},avatarSize:28,richOnHover:!0}),s.default.createElement("span",{style:{fontSize:13,display:"inline-block",flex:1,height:18,color:"rgba(0,0,0,0.23)",fontWeight:500,paddingLeft:8,whiteSpace:"nowrap"}},x(n.updated).fromNow()),void 0),l)}}]),t}();(n.default=r).PropTypes={activity:o.default.object,listContext:o.default.string,displayContext:o.default.oneOf(["infoPanel","popover"])},n.default=r=(0,a.muiThemeable)()(r),n.default=r=e(r),t.exports=n.default},{"./DocLink":5,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/path":"pydio/util/path",react:"react","react-markdown":"react-markdown"}],2:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var h=i(e("react")),r=i(e("prop-types")),m=e("material-ui"),a=i(e("pydio")),c=i(e("./Client")),b=i(e("./Activity"));function i(e){return e&&e.__esModule?e:{default:e}}function l(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function v(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=a.default.requireLib("boot"),e=g.PydioContextConsumer,O=g.moment,w=a.default.requireLib("components").EmptyStateView,a=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,h["default"].Component);var e,t,n,r=d(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=r.call(this,e),e.items?t.state={data:{items:e.items},offset:0,loadMore:!1,loading:!1}:t.state={data:[],offset:0,loadMore:!0,loading:!1},t}return e=o,(t=[{key:"mergeMoreFeed",value:function(e,t){var n=e.items.map(function(e){return e.id}),r=t.items.filter(function(e){return-1===n.indexOf(e.id)});if(!r.length)return this.setState({loadMore:!1}),e;t=e;return t.items=[].concat(u(e.items),u(r)),t.totalItems=t.items.length,t}},{key:"loadForProps",value:function(e){var t=this,n=e.context,r=e.pointOfView,o=e.contextData,a=e.limit,e=this.state,i=e.offset,l=e.data;void 0===a&&(a=-1),0<i&&(a=100),this.setState({loading:!0,error:null}),c.default.loadActivityStreams(n,o,"outbox",r,i,a).then(function(e){0<i&&l&&l.items?e&&e.items&&t.setState({data:t.mergeMoreFeed(l,e)}):t.setState({data:e}),e&&e.items&&e.items.length||t.setState({loadMore:!1}),t.setState({loading:!1})}).catch(function(e){t.setState({loading:!1,error:e})})}},{key:"componentWillMount",value:function(){var e=this.props,t=e.items,e=e.contextData;t||e&&this.loadForProps(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.items?this.setState({data:{items:e.items},offset:0,loadMore:!1}):e.contextData===this.props.contextData&&e.context===this.props.context||this.setState({offset:0,loadMore:!0},function(){t.loadForProps(e)})}},{key:"render",value:function(){var r,e=this,o=[],t=this.state,n=t.data,a=t.loadMore,i=t.loading,l=t.error,c=this.props,u=c.listContext,s=c.groupByDate,f=c.displayContext,p=c.pydio,t="mdi mdi-pulse",c=i?p.MessageHash["notification_center.17"]:p.MessageHash["notification_center.18"];if(l&&(c=l.Detail||l.msg||l,t="mdi mdi-alert-circle-outline"),null!==n&&n.items&&(n.items.forEach(function(e,t){var n=O(e.updated).fromNow();s&&n!==r&&(o.length?(o.pop(),o.push(h.default.createElement("div",{style:{padding:"20px 16px 0",fontSize:13,color:"rgba(147, 168, 178, 0.67)",fontWeight:500}},n))):o.push(h.default.createElement("div",{style:{padding:"0 16px",fontSize:13,color:"rgba(147, 168, 178, 0.67)",fontWeight:500}},n))),o.push(h.default.createElement(b.default,{key:e.id,activity:e,listContext:u,oneLiner:s,displayContext:f})),s&&(r=n,o.push(h.default.createElement("div",{style:{borderTop:"1px solid rgba(0,0,0,.03)",width:"100%"}})))}),s&&o.pop()),o.length&&a&&o.push(h.default.createElement("div",{style:{paddingLeft:16}},h.default.createElement(m.FlatButton,{primary:!0,label:i?p.MessageHash["notification_center.20"]:p.MessageHash["notification_center.19"],disabled:i,onClick:function(){e.setState({offset:n.items.length+1},function(){e.loadForProps(e.props)})}}))),o.length)return h.default.createElement(m.List,{style:this.props.style},o);var d,y,i={backgroundColor:"transparent"};return"popover"===f?i=v(v({},i),{},{minHeight:250}):"infoPanel"===f&&(i=v(v({},i),{},{paddingBottom:20,paddingTop:10}),d={fontSize:40},y={fontSize:13}),h.default.createElement(w,{pydio:this.props.pydio,iconClassName:t,primaryTextId:c,style:i,iconStyle:d,legendStyle:y})}}])&&f(e.prototype,t),n&&f(e,n),o}();(n.default=a).PropTypes={context:r.default.string,contextData:r.default.string,boxName:r.default.string,pointOfView:r.default.oneOf(["GENERIC","ACTOR","SUBJECT"]),displayContext:r.default.oneOf(["mainList","infoPanel","popover"])},n.default=a=e(a),t.exports=n.default},{"./Activity":1,"./Client":4,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,l=(r=e("pydio/http/api"))&&r.__esModule?r:{default:r},c=e("cells-sdk");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"toggleWatch",value:function(e,n){var r,t,o,a,i;n&&(t=(r=pydio.getUserSelection().getUniqueNode()).getMetadata().get("uuid"),o=pydio.user.id,a=new c.ActivitySubscription,i=new c.ActivityOwnerType,a.UserId=o,a.ObjectId=t,a.ObjectType=i.NODE,i=[],"watch_change"!==n&&"watch_both"!==n||i.push("change"),"watch_read"!==n&&"watch_both"!==n||i.push("read"),a.Events=i,new c.ActivityServiceApi(l.default.getRestClient()).subscribe(a).then(function(e){var t=r.getMetadata().get("overlay_class")||"";"watch_stop"===n?(r.getMetadata().delete("meta_watched"),r.getMetadata().set("overlay_class",t.replace("mdi mdi-bell",""))):(r.getMetadata().set("meta_watched","META_"+n.toUpperCase()),(t=t.replace("mdi mdi-bell","").split(",")).push("mdi mdi-bell"),r.getMetadata().set("overlay_class",t.join(","))),r.notify("node_replaced")}))}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();n.default=a,t.exports=n.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=r(e("pydio")),u=r(e("pydio/http/api")),s=e("cells-sdk");function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"loadActivityStreams",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"USER_ID",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"outbox",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:-1,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:-1;if(!t)return Promise.resolve([]);var i=new s.ActivityServiceApi(u.default.getRestClient()),l=new s.ActivityStreamActivitiesRequest;return l.Context=e,l.ContextData=t,l.BoxName=n,-1<o&&(l.Offset=o),-1<a&&(l.Limit=a),l.Language=c.default.getInstance().user.getPreference("lang")||"",r&&(l.PointOfView=r),i.stream(l)}},{key:"UnreadInbox",value:function(e){var t=new s.ActivityServiceApi(u.default.getRestClient()),n=new s.ActivityStreamActivitiesRequest;return n.Context="USER_ID",n.ContextData=e,n.BoxName="inbox",n.UnreadCountOnly=!0,t.stream(n).then(function(e){return e.totalItems||0})}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api"}],5:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.nodesFromObject=S,n.default=void 0;var d=a(e("react")),r=a(e("prop-types"));function a(e){return e&&e.__esModule?e:{default:e}}function i(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function y(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=e("material-ui"),b=m.Popover,v=m.Paper,g=m.IconButton,O=m.FlatButton,w=m.Divider,_=e("pydio"),P=e("lodash.debounce"),j=e("pydio/model/meta-node-provider"),m=_.requireLib("boot").PydioContextConsumer;_.requireLib("workspaces").FilePreview;function S(e,t){var n=[],r=t.user.getActiveRepository();if(!(e&&e.partOf&&e.partOf.items&&e.partOf.items.length))return n;for(var o=0;o<e.partOf.items.length;o++){var a=e.partOf.items[o],i=a.rel.split("/");i.shift();var l=i.join("/");0!==l.indexOf("/")&&(l="/"+l);i=new AjxpNode(l,"Document"===e.type);if(i.getMetadata().set("repository_id",a.id),i.getMetadata().set("repository_label",a.name),i.getMetadata().set("filename",l),a.id===r)return[i];n.push(i)}return n}var x=function(){s(r,d["default"].Component);var n=p(r);function r(e){l(this,r);var t=n.call(this,e),e=S(e.activity.object,e.pydio);return e.length&&!e[0].isLeaf()?t.state={previewLoaded:!0,previewFailed:!1,nodes:e}:t.state={previewLoaded:!1,previewFailed:!1,nodes:e},t}return u(r,[{key:"render",value:function(){var t,n,r=this,o=this.props.pydio,e=this.state,a=e.previewLoaded,i=e.nodes,l=e.previewFailed,c=i.length?i[0]:null,e={height:200,display:"flex",alignItems:"center",justifyContent:"center",fontSize:70};c&&c.isLeaf()&&(a&&!l||(a&&l?y(y({},e),{},{flexDirection:"column"}):(t=c.getMetadata().get("repository_id"),n=c.getMetadata().get("repository_label"),a=new j,c.observeOnce("error",function(){r.setState({previewLoaded:!0,previewFailed:!0})}),a.loadLeafNodeSync(c,function(e){e.getMetadata().set("repository_id",t),e.getMetadata().set("repository_label",n),i[0]=e,r.setState({previewLoaded:!0,nodes:i})},!0,{tmp_repository_id:t}))));for(var u,s=[],f=o.user.getActiveRepository(),p=0;p<i.length;p++)if("break"===function(e){var t=i[e],n=d.default.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:10}},d.default.createElement("div",{style:{flex:1,fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.33)"}},o.MessageHash["notification_center.16"]," ",t.getMetadata().get("repository_label")),d.default.createElement(g,{iconClassName:"mdi mdi-open-in-new",tooltip:o.MessageHash["notification_center.6"],tooltipPosition:"top-center",onClick:function(){o.goTo(t)}}));if(t.getMetadata().get("repository_id")===f)return u=d.default.createElement("div",{style:{display:"flex",alignItems:"center"}},d.default.createElement("span",{style:{flex:1}})," ",d.default.createElement(O,{label:o.MessageHash["notification_center.6"],iconClassName:"mdi mdi-open-in-new",tooltip:"Open",tooltipPosition:"top-right",onClick:function(){o.goTo(t)}})),"break";s.push(n),e<i.length-1&&s.push(d.default.createElement(w,null))}(p))break;return u&&(s=[u]),d.default.createElement("div",null,!l&&d.default.createElement("div",{style:{padding:6}},s))}}]),r}(),e=function(){s(n,d["default"].Component);var t=p(n);function n(e){return l(this,n),(e=t.call(this,e)).state={showPopover:!1,popoverAnchor:null},e}return u(n,[{key:"render",value:function(){var t=this,e=this.props,n=e.pydio,r=e.activity,o=e.children,a=e.linkStyle;r.object.name||(r.object.name="");var i=S(r.object,n),e=r.object.name.replace("doc://","").split("/");e.shift();var l,c,u,s,e="/"+e.join("/");return 1<i.length?(l=function(){n.goTo(i[0])},c=P(function(){t.setState({showPopover:!1})},350),u=function(e){t.setState({showPopover:!0,popoverAnchor:e.currentTarget}),c.cancel()},s=d.default.createElement(b,{open:this.state.showPopover,anchorEl:this.state.popoverAnchor,onRequestClose:function(e){"clickAway"!==e&&t.setState({showPopover:!1})},anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},useLayerForClickAway:!1},d.default.createElement(v,{zDepth:2,style:{width:200,height:"auto",overflowY:"auto"},onMouseOver:function(e){t.setState({showPopover:!0}),c.cancel()},onMouseOut:c},d.default.createElement(x,{pydio:n,activity:r})))):1===i.length&&(l=function(){n.goTo(i[0])}),d.default.createElement("span",null,d.default.createElement("a",{title:e,style:y({cursor:"pointer",color:"rgb(66, 140, 179)"},a),onMouseOver:u,onMouseOut:c,onClick:l},o),s)}}]),n}();(n.default=e).PropTypes={activity:r.default.object,pydio:r.default.instanceOf(_)},n.default=e=m(e)},{"lodash.debounce":"lodash.debounce","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/meta-node-provider":"pydio/model/meta-node-provider",react:"react"}],6:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("react")),i=(e("material-ui"),r(e("./ActivityList")));function r(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=r?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=Pydio.requireLib("boot").PydioContextConsumer,p=Pydio.requireLib("workspaces").InfoPanelCard,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,a["default"].Component);var e,t,n,r=u(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"render",value:function(){var e=this.props,t=e.node,n=e.pydio,r=e.popoverPanel;if(!1===n.getPluginConfigs("core.activitystreams").get("ACTIVITY_SHOW_ACTIVITIES"))return null;var o=t.isLeaf()?"activity.leaf":"activity.folder",e=!t.isLeaf(),n=t.isLeaf()?n.MessageHash["notification_center.11"]:n.MessageHash["notification_center.10"];return a.default.createElement(p,{key:o,identifier:o,defaultOpen:e,title:n,popoverPanel:r},a.default.createElement(i.default,{context:"NODE_ID",contextData:t.getMetadata().get("uuid"),boxName:"outbox",style:{overflowY:"scroll",maxHeight:380,padding:"8px 12px"},listContext:"NODE-"+(t.isLeaf()?"LEAF":"COLLECTION"),pointOfView:"ACTOR",displayContext:"infoPanel"}))}}])&&l(e.prototype,t),n&&l(e,n),o}();n.default=e,n.default=e=f(e),t.exports=n.default},{"./ActivityList":2,"material-ui":"material-ui",react:"react"}],7:[function(e,t,n){!function(a){!function(){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dynamicBuilder",value:function(e){var t=a.pydio,n=t.MessageHash,r=t.getUserSelection().getUniqueNode();if(!r)return[];var o,t=[];return r.getMetadata().get("meta_watched")&&(o=r.getMetadata().get("meta_watched")),t.push({name:n["meta.watch.11"],alt:n["meta.watch."+(r.isLeaf()?"12":"12b")],icon_class:o&&"META_WATCH_CHANGE"===o?"mdi mdi-checkbox-marked-circle-outline":"mdi mdi-checkbox-blank-circle-outline",callback:function(e){this.apply("watch_change")}.bind(this)}),t.push({name:n["meta.watch.9"],alt:n["meta.watch."+(r.isLeaf()?"10":"10b")],icon_class:o&&"META_WATCH_READ"===o?"mdi mdi-checkbox-marked-circle-outline":"mdi mdi-checkbox-blank-circle-outline",callback:function(e){this.apply("watch_read")}.bind(this)}),t.push({name:n["meta.watch.13"],alt:n["meta.watch."+(r.isLeaf()?"14":"14b")],icon_class:o&&"META_WATCH_BOTH"===o?"mdi mdi-checkbox-marked-circle-outline":"mdi mdi-checkbox-blank-circle-outline",callback:function(e){this.apply("watch_both")}.bind(this)}),o&&(t.push({separator:!0}),t.push({name:n["meta.watch.3"],alt:n["meta.watch."+(r.isLeaf()?"8":"4")],icon_class:"mdi mdi-close-circle-outline",callback:function(e){this.apply("watch_stop")}.bind(this)})),t}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}(),t.exports=n.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};t=c(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((a=o?Object.getOwnPropertyDescriptor(e,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("react")),r=o(e("pydio")),l=o(e("./WatchSelector"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n);return e=r?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=r.default.requireLib("workspaces").InfoPanelCard,r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(o,a.Component);var e,t,n,r=f(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.node,r=e.style,e=e.popoverPanel;return a.default.createElement(d,{identifier:"meta-user",style:r,title:t.MessageHash["meta.watch.1-off"],popoverPanel:e},a.default.createElement("div",{style:{padding:"0 16px 10px"}},a.default.createElement(l.default,{pydio:t,nodes:[n]})))}}])&&u(e.prototype,t),n&&u(e,n),o}();n.default=r,t.exports=n.default},{"./WatchSelector":10,pydio:"pydio",react:"react"}],9:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var l=f(e("react")),c=e("material-ui"),r=e("material-ui/styles"),a=f(e("./Client")),u=f(e("./ActivityList")),i=f(e("lodash.debounce")),s=f(e("color"));function f(e){return e&&e.__esModule?e:{default:e}}function p(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function d(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?p(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(n);return e=r?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?b(t):e}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(o,l["default"].Component);var e,t,n,r=m(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,e)).state={unreadStatus:0,open:!1,data:[]},e.reloadData=(0,i.default)(e.reloadData.bind(b(e)),500),e.reloadUnread=(0,i.default)(e.reloadUnread.bind(b(e)),500),e}return e=o,(t=[{key:"reloadData",value:function(){var t=this;a.default.loadActivityStreams("USER_ID",this.props.pydio.user.id,"inbox").then(function(e){t.setState({data:e})}).catch(function(e){t.setState({error:e})})}},{key:"reloadUnread",value:function(){var t=this;a.default.UnreadInbox(this.props.pydio.user.id).then(function(e){t.setState({unreadStatus:e})}).catch(function(e){})}},{key:"onStatusChange",value:function(){this.props.onUnreadStatusChange&&this.props.onUnreadStatusChange(this.state.unreadStatus)}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.reloadData(),this.setState({open:!0,anchorEl:e.currentTarget,unreadStatus:0},this.onStatusChange.bind(this))}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"componentWillMount",value:function(){var t=this;this.reloadUnread(),this.props.pydio.observe("websocket_event:activity",function(e){t.state.open?t.reloadData():t.reloadUnread()})}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.iconStyle,r=e.muiTheme,o=this.state,a=o.open,i=o.anchorEl,e=o.unreadStatus,o={borderRadius:"50%"};return a&&n&&n.color&&(o=d(d({},o),{},{backgroundColor:(0,s.default)(n.color).fade(.9).toString()})),l.default.createElement("span",null,l.default.createElement("div",{style:{position:"relative",display:"inline-block"},badgeContent:this.state.unreadStatus,secondary:!0,badgeStyle:this.state.unreadStatus?null:{display:"none"}},l.default.createElement(c.IconButton,{onClick:this.handleTouchTap.bind(this),iconClassName:this.props.iconClassName||"mdi mdi-bell",tooltip:(e?e+" ":"")+this.props.pydio.MessageHash["notification_center.4"],className:"userActionButton alertsButton",iconStyle:n,style:o}),0<e&&l.default.createElement("div",{style:{width:6,height:6,borderRadius:"50%",top:9,right:6,position:"absolute",backgroundColor:r.palette.accent1Color}})),l.default.createElement(c.Popover,{open:a,anchorEl:i,anchorOrigin:{horizontal:"left",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this),style:{width:320},zDepth:3},l.default.createElement("div",{style:{display:"flex",alignItems:"center",borderRadius:"2px 2px 0 0",width:"100%",backgroundColor:"#f8fafc",borderBottom:"1px solid #ECEFF1",color:r.palette.primary1Color}},l.default.createElement("span",{className:"mdi mdi-bell",style:{fontSize:18,margin:"12px 8px 14px 16px"}}),l.default.createElement("span",{style:{fontSize:15,fontWeight:500}},t.MessageHash["notification_center.1"])),this.state.data&&l.default.createElement(u.default,{items:this.state.data.items,style:{overflowY:"scroll",maxHeight:420,paddingTop:20},groupByDate:!0,displayContext:"popover"})))}}])&&y(e.prototype,t),n&&y(e,n),o}();n.default=e,n.default=e=(0,r.muiThemeable)()(e),t.exports=n.default},{"./ActivityList":2,"./Client":4,color:"color","lodash.debounce":"lodash.debounce","material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],10:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("react")),i=r(e("pydio")),l=e("material-ui"),c=r(e("pydio/http/api")),u=e("cells-sdk");function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(n);return e=r?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=i.default.requireLib("hoc").ModernSelectField,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,a["default"].Component);var e,t,n,r=p(o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t,e=(t=r.call(this,e)).props.nodes;return t.state=t.valueFromNodes(e),t}return e=o,(t=[{key:"valueFromNodes",value:function(){var t=!1,n=void 0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){e=e.getMetadata().get("meta_watched")||"";void 0!==n&&e!==n&&(t=!0),n=e}),{value:n,mixed:t}}},{key:"onSelectorChange",value:function(a){var i,e,t=this;"mixed"!==a&&(e=this.props,i=e.pydio,e=e.nodes,this.setState({saving:!0}),e=e.map(function(n){var e=n.getMetadata().get("uuid"),t=i.user.id,r=new u.ActivitySubscription,o=new u.ActivityOwnerType;r.UserId=t,r.ObjectId=e,r.ObjectType=o.NODE;o=[];return"META_WATCH_CHANGE"!==a&&"META_WATCH_BOTH"!==a||o.push("change"),"META_WATCH_READ"!==a&&"META_WATCH_BOTH"!==a||o.push("read"),r.Events=o,new u.ActivityServiceApi(c.default.getRestClient()).subscribe(r).then(function(e){var t=n.getMetadata().get("overlay_class")||"";""===a?(n.getMetadata().delete("meta_watched"),n.getMetadata().set("overlay_class",t.replace("mdi mdi-bell",""))):(n.getMetadata().set("meta_watched",a),(t=t.replace("mdi mdi-bell","").split(",")).push("mdi mdi-bell"),n.getMetadata().set("overlay_class",t.join(","))),n.notify("node_replaced")})}),Promise.all(e).then(function(){t.setState({value:a,mixed:!1}),window.setTimeout(function(){t.setState({saving:!1})},250)}).catch(function(){t.setState({saving:!1})}))}},{key:"render",value:function(){var r=this,e=this.state,t=e.value,n=e.mixed,o=e.saving,e=i.default.getInstance().MessageHash;return o?a.default.createElement(y,{value:"saving",onChange:function(e,t,n){},disabled:!0},a.default.createElement(l.MenuItem,{value:"saving",primaryText:e["meta.watch.selector.saving"]+"..."})):a.default.createElement(y,{value:n?"mixed":t,onChange:function(e,t,n){r.onSelectorChange(n)}},n&&a.default.createElement(l.MenuItem,{value:"mixed",primaryText:e["meta.watch.selector.mixed"]+"..."}),a.default.createElement(l.MenuItem,{value:"",primaryText:e["meta.watch.selector.ignore"]}),a.default.createElement(l.MenuItem,{value:"META_WATCH_READ",primaryText:e["meta.watch.selector.read"]}),a.default.createElement(l.MenuItem,{value:"META_WATCH_CHANGE",primaryText:e["meta.watch.selector.change"]}),a.default.createElement(l.MenuItem,{value:"META_WATCH_BOTH",primaryText:e["meta.watch.selector.both"]}))}}])&&s(e.prototype,t),n&&s(e,n),o}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"InfoPanel",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"UserPanel",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"ASClient",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"Activity",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"ActivityList",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"Listener",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"Callbacks",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"WatchSelector",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"OverlayPanel",{enumerable:!0,get:function(){return f.default}});var r=p(e("./InfoPanel")),o=p(e("./UserPanel")),a=p(e("./Client")),i=p(e("./Activity")),l=p(e("./ActivityList")),c=p(e("./Listener")),u=p(e("./Callbacks")),s=p(e("./WatchSelector")),f=p(e("./OverlayPanel"));function p(e){return e&&e.__esModule?e:{default:e}}},{"./Activity":1,"./ActivityList":2,"./Callbacks":3,"./Client":4,"./InfoPanel":6,"./Listener":7,"./OverlayPanel":8,"./UserPanel":9,"./WatchSelector":10}]},{},[11])(11)});